<!DOCTYPE html>
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<html lang="en-US" dir="ltr">
<!--******************************************-->
<!--*  Authored with PreTeXt                 *-->
<!--*  pretextbook.org                       *-->
<!--*  Theme: default-modern                 *-->
<!--*  Palette:                              *-->
<!--******************************************-->
<head xmlns:og="http://ogp.me/ns#" xmlns:book="https://ogp.me/ns/book#">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Introduction to statistical testing</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0">
<link href="_static/pretext/css/theme.css" rel="stylesheet" type="text/css">
<link href="_static/pretext/css/ol-markers.css" rel="stylesheet" type="text/css">
<script>
var runestoneMathReady = new Promise((resolve) => window.rsMathReady = resolve);
window.MathJax = {
  "tex": {
    "inlineMath": [
      [
        "\\(",
        "\\)"
      ]
    ],
    "tags": "none",
    "tagSide": "right",
    "tagIndent": ".8em",
    "packages": {
      "[+]": [
        "base",
        "extpfeil",
        "ams",
        "amscd",
        "color",
        "newcommand",
        "knowl"
      ]
    }
  },
  "options": {
    "ignoreHtmlClass": "tex2jax_ignore|ignore-math",
    "processHtmlClass": "process-math",
    "renderActions": {
      "findScript": [
        10,
        function (doc) {
            document.querySelectorAll('script[type^="math/tex"]').forEach(function(node) {
                var display = !!node.type.match(/; *mode=display/);
                var math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                var text = document.createTextNode('');
                node.parentNode.replaceChild(text, node);
                math.start = {node: text, delim: '', n: 0};
                math.end = {node: text, delim: '', n: 0};
                doc.math.push(math);
            });
        },
        ""
      ]
    }
  },
  "chtml": {
    "scale": 0.98,
    "mtextInheritFont": true
  },
  "loader": {
    "load": [
      "input/asciimath",
      "[tex]/extpfeil",
      "[tex]/amscd",
      "[tex]/color",
      "[tex]/newcommand",
      "[pretext]/mathjaxknowl3.js"
    ],
    "paths": {
      "pretext": "_static/pretext/js/lib"
    }
  },
  "startup": {
    pageReady() {
      return MathJax.startup.defaultPageReady().then(function () {
      console.log("in ready function");
      rsMathReady();
      }
    )}
  }
};
</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta property="og:type" content="book">
<meta property="book:title" content="Introduction to Data Science">
<meta property="book:author" content="Hannah Kurzweil">
<script src="_static/pretext/js/lib/jquery.min.js"></script><script src="_static/pretext/js/lib/jquery.sticky.js"></script><script src="_static/pretext/js/lib/jquery.espy.min.js"></script><script src="_static/pretext/js/pretext.js"></script><script src="_static/pretext/js/pretext_add_on.js?x=1"></script><script src="_static/pretext/js/user_preferences.js"></script><!--** eBookCongig is necessary to configure interactive       **-->
<!--** Runestone components to run locally in reader's browser **-->
<!--** No external communication:                              **-->
<!--**     log level is 0, Runestone Services are disabled     **-->
<script type="text/javascript">
eBookConfig = {};
eBookConfig.useRunestoneServices = false;
eBookConfig.host = 'http://127.0.0.1:8000';
eBookConfig.course = 'PTX_Course_Title_Here';
eBookConfig.basecourse = 'PTX_Base_Course';
eBookConfig.isLoggedIn = false;
eBookConfig.email = '';
eBookConfig.isInstructor = false;
eBookConfig.logLevel = 0;
eBookConfig.username = '';
eBookConfig.readings = null;
eBookConfig.activities = null;
eBookConfig.downloadsEnabled = false;
eBookConfig.allow_pairs = false;
eBookConfig.enableScratchAC = false;
eBookConfig.build_info = "";
eBookConfig.python3 = null;
eBookConfig.runestone_version = '7.6.3';
eBookConfig.jobehost = '';
eBookConfig.proxyuri_runs = '';
eBookConfig.proxyuri_files = '';
eBookConfig.enable_chatcodes =  false;
</script>
<!--*** Runestone Services ***-->
<script src="_static/prefix-runtime.1dbf799015a9933a.bundle.js"></script><script src="_static/prefix-723.3e6434f80549315a.bundle.js"></script><script src="_static/prefix-runestone.253ff4af1e53e55f.bundle.js"></script><link rel="stylesheet" type="text/css" href="_static/prefix-723.3bccd435914aa0ff.css">
<link rel="stylesheet" type="text/css" href="_static/prefix-runestone.541c9106f2c605b9.css">
<script src="https://sagecell.sagemath.org/static/embedded_sagecell.js"></script><script src="_static/pretext/js/lti_iframe_resizer.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/components/prism-core.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/autoloader/prism-autoloader.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/line-numbers/prism-line-numbers.min.js" integrity="sha512-dubtf8xMHSQlExGRQ5R7toxHLgSDZ0K7AunqPWHXmJQ8XyVIG19S1T95gBxlAeGOK02P4Da2RTnQz0Za0H0ebQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/line-highlight/prism-line-highlight.min.js" integrity="sha512-93uCmm0q+qO5Lb1huDqr7tywS8A2TFA+1/WHvyiWaK6/pvsFl6USnILagntBx8JnVbQH5s3n0vQZY6xNthNfKA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.9/lunr.min.js" integrity="sha512-4xUl/d6D6THrAnXAwGajXkoWaeMNwEKK4iNfq5DotEbLPAfk6FSxSP3ydNxqDgCw1c/0Z1Jg6L8h2j+++9BZmg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="lunr-pretext-search-index.js" async=""></script><script src="_static/pretext/js/pretext_search.js"></script><script src="_static/pretext/js/lib/knowl.js"></script><!--knowl.js code controls Sage Cells within knowls--><script>sagecellEvalName='Evaluate (Sage)';
</script>
</head>
<body id="changeme" class="pretext book ignore-math">
<a class="assistive" href="#ptx-content">Skip to main content</a><header id="ptx-masthead" class="ptx-masthead"><div class="ptx-banner"><div class="title-container">
<h1 class="heading"><a href="data-science-intro.html"><span class="title">Introduction to Data Science:</span> <span class="subtitle">Unlocking Insights from Data</span></a></h1>
<p class="byline">Hannah Kurzweil</p>
</div></div></header><nav id="ptx-navbar" class="ptx-navbar navbar"><div class="ptx-navbar-contents">
<button class="toc-toggle button" title="Contents"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5d2;</span><span class="name">Contents</span></button><div class="searchbox">
<div class="searchwidget"><button id="searchbutton" class="searchbutton button" type="button" title="Search book"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe8b6;</span><span class="name">Search Book</span></button></div>
<div id="searchresultsplaceholder" class="searchresultsplaceholder" style="display: none">
<div class="search-results-controls">
<input aria-label="Search term" id="ptxsearch" class="ptxsearch" type="text" name="terms" placeholder="Search term"><button title="Close search" id="closesearchresults" class="closesearchresults"><span class="material-symbols-outlined">close</span></button>
</div>
<h2 class="search-results-heading">Search Results: </h2>
<div id="searchempty" class="searchempty"><span>No results.</span></div>
<ol id="searchresults" class="searchresults"></ol>
</div>
</div>
<span class="nav-other-controls"><button id="light-dark-button" class="light-dark-button button" title="Dark Mode"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe51c;</span><span class="name">Dark Mode</span></button></span><span class="treebuttons"><a class="previous-button button" href="sec-statistical-analysis.html" title="Previous"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cb;</span><span class="name">Prev</span></a><a class="up-button button" href="ch-data-analysis.html" title="Up"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5ce;</span><span class="name">Up</span></a><a class="next-button button" href="ch-advanced-analysis.html" title="Next"><span class="name">Next</span><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cc;</span></a></span>
</div></nav><div id="latex-macros" class="hidden-content process-math" style="display:none"><span class="process-math">\(\newcommand{\N}{\mathbb N} \newcommand{\Z}{\mathbb Z} \newcommand{\Q}{\mathbb Q} \newcommand{\R}{\mathbb R}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\definecolor{fillinmathshade}{gray}{0.9}
\newcommand{\fillinmath}[1]{\mathchoice{\colorbox{fillinmathshade}{$\displaystyle     \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\textstyle        \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptstyle      \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptscriptstyle\phantom{\,#1\,}$}}}
\)</span></div>
<div class="ptx-page">
<div id="ptx-sidebar" class="ptx-sidebar"><nav id="ptx-toc" class="ptx-toc depth2 focused" data-preexpanded-levels="0" data-max-levels="2"><ul class="structural toc-item-list contains-active">
<li class="toc-item toc-frontmatter"><div class="toc-title-box"><a href="frontmatter.html" class="internal"><span class="title">Front Matter</span></a></div></li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-understanding-data.html" class="internal"><span class="codenumber">1</span> <span class="title">Understanding Data in Our World</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-intro-to-data.html" class="internal"><span class="codenumber">1.1</span> <span class="title">Introduction to Data</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-intro-to-data.html#subsec-what-is-data-science" class="internal"><span class="codenumber">1.1.1</span> <span class="title">What is Data Science and its Applications?</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-intro-to-data.html#subsec-data-daily-lives" class="internal"><span class="codenumber">1.1.2</span> <span class="title">Explore how data shapes our daily lives</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-intro-to-data.html#subsec-web-r-setup" class="internal"><span class="codenumber">1.1.3</span> <span class="title">Set up Web-R accounts and platform familiarization</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-types-of-data.html" class="internal"><span class="codenumber">1.2</span> <span class="title">Types of data and their characteristics</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-types-of-data.html#subsec-qualitative-quantitative" class="internal"><span class="codenumber">1.2.1</span> <span class="title">Qualitative vs. quantitative data</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-types-of-data.html#subsec-structured-unstructured" class="internal"><span class="codenumber">1.2.2</span> <span class="title">Structured vs. unstructured data</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-types-of-data.html#subsec-data-types-activity" class="internal"><span class="codenumber">1.2.3</span> <span class="title">Activity: Identifying data types in real-world examples</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-data-collection.html" class="internal"><span class="codenumber">1.3</span> <span class="title">Data Collection and Sources</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-collection.html#subsec-data-collection-methods" class="internal"><span class="codenumber">1.3.1</span> <span class="title">How data is collected and by whom</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-collection.html#subsec-data-collection-organizations" class="internal"><span class="codenumber">1.3.2</span> <span class="title">Organizations that collect data and their motivations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-collection.html#subsec-dikw-pyramid" class="internal"><span class="codenumber">1.3.3</span> <span class="title">Introduction to the DIKW pyramid</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-collection.html#subsec-ethics-data-collection" class="internal"><span class="codenumber">1.3.4</span> <span class="title">Discussion: Ethics of data collection</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-data-sources.html" class="internal"><span class="codenumber">1.4</span> <span class="title">Primary vs. secondary data sources</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-sources.html#subsec-primary-secondary-data" class="internal"><span class="codenumber">1.4.1</span> <span class="title">Distinguishing between data sources</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-sources.html#subsec-reliability-validity" class="internal"><span class="codenumber">1.4.2</span> <span class="title">Reliability and validity of different sources</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-sources.html#subsec-personal-data-tracking" class="internal"><span class="codenumber">1.4.3</span> <span class="title">Mini-project introduction: Personal data tracking exercise</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-data-quality.html" class="internal"><span class="codenumber">1.5</span> <span class="title">Data Quality and Evaluation</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-quality.html#subsec-dataset-quality" class="internal"><span class="codenumber">1.5.1</span> <span class="title">Evaluating dataset quality</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-quality.html#subsec-5vs-framework" class="internal"><span class="codenumber">1.5.2</span> <span class="title">The 5Vs framework: Volume, Velocity, Variety, Veracity, Value</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-quality.html#subsec-identifying-biases" class="internal"><span class="codenumber">1.5.3</span> <span class="title">Identifying biases in datasets</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-quality.html#subsec-apply-5vs" class="internal"><span class="codenumber">1.5.4</span> <span class="title">Activity: Apply 5Vs to evaluate sample datasets</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-data-decision-making.html" class="internal"><span class="codenumber">1.6</span> <span class="title">Data and decision-making</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-decision-making.html#subsec-data-decision-levels" class="internal"><span class="codenumber">1.6.1</span> <span class="title">How data informs decisions at different levels</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-decision-making.html#subsec-data-driven-case-studies" class="internal"><span class="codenumber">1.6.2</span> <span class="title">Case studies of data-driven decision making</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-decision-making.html#subsec-personal-data-tracking-checkin" class="internal"><span class="codenumber">1.6.3</span> <span class="title">Mini-project check-in: Personal data tracking discussion</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-data-impact.html" class="internal"><span class="codenumber">1.7</span> <span class="title">Data Impact and Ethics</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-impact.html#subsec-data-equity-impact" class="internal"><span class="codenumber">1.7.1</span> <span class="title">Data’s impact on equity and society</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-impact.html#subsec-data-bias-impact" class="internal"><span class="codenumber">1.7.2</span> <span class="title">How data can perpetuate or mitigate biases</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-impact.html#subsec-algorithmic-bias-cases" class="internal"><span class="codenumber">1.7.3</span> <span class="title">Case studies in algorithmic bias</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-impact.html#subsec-responsible-data-practices" class="internal"><span class="codenumber">1.7.4</span> <span class="title">Discussion: Responsible data practices</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-unit-project.html" class="internal"><span class="codenumber">1.8</span> <span class="title">Unit 1 Project Work</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-unit-project.html#subsec-personal-data-analysis" class="internal"><span class="codenumber">1.8.1</span> <span class="title">Mini-project completion: Personal data tracking analysis</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-unit-project.html#subsec-group-presentations" class="internal"><span class="codenumber">1.8.2</span> <span class="title">Group presentations of findings</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-unit-project.html#subsec-data-reflection" class="internal"><span class="codenumber">1.8.3</span> <span class="title">Reflection on data’s role in students’ lives</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-computational-foundations.html" class="internal"><span class="codenumber">2</span> <span class="title">Computational Foundations with Web-R</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-intro-to-web-r.html" class="internal"><span class="codenumber">2.1</span> <span class="title">Introduction to Web-R</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-intro-to-web-r.html#subsec-r-environment" class="internal"><span class="codenumber">2.1.1</span> <span class="title">R environment overview and basic syntax</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-intro-to-web-r.html#subsec-variables-datatypes" class="internal"><span class="codenumber">2.1.2</span> <span class="title">Variables, data types, and basic operations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-intro-to-web-r.html#subsec-r-practice" class="internal"><span class="codenumber">2.1.3</span> <span class="title">Hands-on practice: Simple calculations and variable assignments</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-data-structures.html" class="internal"><span class="codenumber">2.2</span> <span class="title">Working with data structures</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-structures.html#subsec-r-data-structures" class="internal"><span class="codenumber">2.2.1</span> <span class="title">Vectors, lists, and data frames</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-structures.html#subsec-manipulating-structures" class="internal"><span class="codenumber">2.2.2</span> <span class="title">Creating and manipulating basic data structures</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-structures.html#subsec-exercise-data-structures" class="internal"><span class="codenumber">2.2.3</span> <span class="title">Exercise: Building and transforming data structures</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-data-import.html" class="internal"><span class="codenumber">2.3</span> <span class="title">Data Import and Exploration</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-import.html#subsec-importing-data" class="internal"><span class="codenumber">2.3.1</span> <span class="title">Reading CSV files and other data formats</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-import.html#subsec-data-inspection" class="internal"><span class="codenumber">2.3.2</span> <span class="title">Basic data inspection functions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-import.html#subsec-activity-import-explore" class="internal"><span class="codenumber">2.3.3</span> <span class="title">Activity: Import and explore a dataset of interest</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-data-exploration.html" class="internal"><span class="codenumber">2.4</span> <span class="title">Data exploration techniques</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-exploration.html#subsec-summary-statistics" class="internal"><span class="codenumber">2.4.1</span> <span class="title">Summary statistics and data summaries</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-exploration.html#subsec-initial-visualization" class="internal"><span class="codenumber">2.4.2</span> <span class="title">Initial data visualization</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-exploration.html#subsec-exploratory-analysis" class="internal"><span class="codenumber">2.4.3</span> <span class="title">Exercise: Exploratory analysis of a dataset</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-data-transformation.html" class="internal"><span class="codenumber">2.5</span> <span class="title">Data Transformation</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-transformation.html#subsec-filtering-selecting" class="internal"><span class="codenumber">2.5.1</span> <span class="title">Filtering and selecting data</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-transformation.html#subsec-subsetting-dataframes" class="internal"><span class="codenumber">2.5.2</span> <span class="title">Subsetting data frames</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-transformation.html#subsec-activity-extract-subsets" class="internal"><span class="codenumber">2.5.3</span> <span class="title">Activity: Extract meaningful subsets from datasets</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-creating-transforming-variables.html" class="internal"><span class="codenumber">2.6</span> <span class="title">Creating and transforming variables</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-creating-transforming-variables.html#subsec-adding-modifying-columns" class="internal"><span class="codenumber">2.6.1</span> <span class="title">Adding and modifying columns</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-creating-transforming-variables.html#subsec-reshaping-data" class="internal"><span class="codenumber">2.6.2</span> <span class="title">Reshaping data (wide vs. long format)</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-creating-transforming-variables.html#subsec-group-work-transformation" class="internal"><span class="codenumber">2.6.3</span> <span class="title">Group work: Begin transforming a dataset for mid-term project</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-working-with-web-data.html" class="internal"><span class="codenumber">2.7</span> <span class="title">Working with Web Data</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-working-with-web-data.html#subsec-intro-to-apis" class="internal"><span class="codenumber">2.7.1</span> <span class="title">Introduction to APIs</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-working-with-web-data.html#subsec-using-r-with-apis" class="internal"><span class="codenumber">2.7.2</span> <span class="title">Using R to access web data</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-working-with-web-data.html#subsec-api-demonstration" class="internal"><span class="codenumber">2.7.3</span> <span class="title">Demonstration: Extracting data from a simple API</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-working-with-web-data.html#subsec-web-project-work" class="internal"><span class="codenumber">2.7.4</span> <span class="title">Web data project work</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-mid-term-project.html" class="internal"><span class="codenumber">2.8</span> <span class="title">Mid-Term Project Topic</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-mid-term-project.html#subsec-project-work-session" class="internal"><span class="codenumber">2.8.1</span> <span class="title">Mid-term project work session</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-mid-term-project.html#subsec-consultations" class="internal"><span class="codenumber">2.8.2</span> <span class="title">Instructor and peer consultations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-mid-term-project.html#subsec-progress-checkins" class="internal"><span class="codenumber">2.8.3</span> <span class="title">Progress check-ins</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-mid-term-presentations.html" class="internal"><span class="codenumber">2.9</span> <span class="title">Mid-term project presentations</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-mid-term-presentations.html#subsec-presentation-guidelines" class="internal"><span class="codenumber">2.9.1</span> <span class="title">Presentation guidelines</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-mid-term-presentations.html#subsec-presentation-session" class="internal"><span class="codenumber">2.9.2</span> <span class="title">Groups present their data transformation and analysis</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-mid-term-presentations.html#subsec-feedback-discussion" class="internal"><span class="codenumber">2.9.3</span> <span class="title">Peer feedback and discussion</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-mid-term-presentations.html#subsec-computational-reflection" class="internal"><span class="codenumber">2.9.4</span> <span class="title">Reflection on computational techniques learned</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-chapter contains-active">
<div class="toc-title-box"><a href="ch-data-analysis.html" class="internal"><span class="codenumber">3</span> <span class="title">Data Analysis and Visualization with Web-R</span></a></div>
<ul class="structural toc-item-list contains-active">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-visualization-principles.html" class="internal"><span class="codenumber">3.1</span> <span class="title">Data Visualization Principles</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-visualization-principles.html#subsec-effective-visualization" class="internal"><span class="codenumber">3.1.1</span> <span class="title">Principles of effective visualization</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-visualization-principles.html#subsec-visual-perception" class="internal"><span class="codenumber">3.1.2</span> <span class="title">Visual perception principles</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-visualization-principles.html#subsec-choosing-charts" class="internal"><span class="codenumber">3.1.3</span> <span class="title">Choosing appropriate chart types</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-visualization-principles.html#subsec-critique-visualizations" class="internal"><span class="codenumber">3.1.4</span> <span class="title">Activity: Critique and improve sample visualizations</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-intro-ggplot2.html" class="internal"><span class="codenumber">3.2</span> <span class="title">Introduction to ggplot2</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-intro-ggplot2.html#subsec-ggplot2-intro" class="internal"><span class="codenumber">3.2.1</span> <span class="title">Grammar of graphics concept</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-intro-ggplot2.html#subsec-basic-ggplot" class="internal"><span class="codenumber">3.2.2</span> <span class="title">Creating basic plots in ggplot2</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-intro-ggplot2.html#subsec-transform-to-ggplot" class="internal"><span class="codenumber">3.2.3</span> <span class="title">Exercise: Transform basic R plots into ggplot2</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-advanced-visualizations.html" class="internal"><span class="codenumber">3.3</span> <span class="title">Advanced Visualizations</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-advanced-visualizations.html#subsec-single-var-viz" class="internal"><span class="codenumber">3.3.1</span> <span class="title">Histograms, density plots, and bar charts</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-advanced-visualizations.html#subsec-aesthetics-themes" class="internal"><span class="codenumber">3.3.2</span> <span class="title">Customizing aesthetics and themes</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-advanced-visualizations.html#subsec-practice-polished-plots" class="internal"><span class="codenumber">3.3.3</span> <span class="title">Hands-on practice: Create polished single-variable plots</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-relationships-viz.html" class="internal"><span class="codenumber">3.4</span> <span class="title">Relationships between variables</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-relationships-viz.html#subsec-scatter-plots" class="internal"><span class="codenumber">3.4.1</span> <span class="title">Scatter plots, line charts, and heatmaps</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-relationships-viz.html#subsec-visualizing-correlations" class="internal"><span class="codenumber">3.4.2</span> <span class="title">Visualizing correlations and patterns</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-relationships-viz.html#subsec-activity-relationship-viz" class="internal"><span class="codenumber">3.4.3</span> <span class="title">Activity: Create visualizations showing relationships in data</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-statistical-analysis.html" class="internal"><span class="codenumber">3.5</span> <span class="title">Statistical Analysis</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-statistical-analysis.html#subsec-descriptive-stats" class="internal"><span class="codenumber">3.5.1</span> <span class="title">Measures of center and spread</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-statistical-analysis.html#subsec-distributions-outliers" class="internal"><span class="codenumber">3.5.2</span> <span class="title">Distributions and outliers</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-statistical-analysis.html#subsec-exercise-stats-summary" class="internal"><span class="codenumber">3.5.3</span> <span class="title">Exercise: Statistical summary of datasets</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section contains-active">
<div class="toc-title-box"><a href="sec-statistical-testing.html" class="internal"><span class="codenumber">3.6</span> <span class="title">Introduction to statistical testing</span></a></div>
<ul class="structural toc-item-list active">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-statistical-testing.html#subsec-confidence-intervals" class="internal"><span class="codenumber">3.6.1</span> <span class="title">Confidence intervals</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-statistical-testing.html#subsec-linear-regression" class="internal"><span class="codenumber">3.6.2</span> <span class="title">Linear regression basics</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-statistical-testing.html#subsec-hypothesis-testing" class="internal"><span class="codenumber">3.6.3</span> <span class="title">Hypothesis testing basics</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-statistical-testing.html#sec-anova-basics" class="internal"><span class="codenumber">3.6.1</span> <span class="title">ANOVA basics</span></a></div></li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-statistical-testing.html#sec-advanced-analysis" class="internal"><span class="codenumber">3.6.2</span> <span class="title">Advanced Analysis and Final Project Work</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-statistical-testing.html#subsec-prediction-modeling" class="internal"><span class="codenumber">3.6.2.1</span> <span class="title">Building simple predictive models</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-statistical-testing.html#subsec-interpreting-models" class="internal"><span class="codenumber">3.6.2.2</span> <span class="title">Interpreting model results</span></a></div></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-chapter"><div class="toc-title-box"><a href="ch-advanced-analysis.html" class="internal"><span class="codenumber">4</span> <span class="title">Advanced Analysis and Final Project Work</span></a></div></li>
<li class="toc-item toc-backmatter"><div class="toc-title-box"><a href="backmatter.html" class="internal"><span class="title">Backmatter</span></a></div></li>
</ul></nav></div>
<main class="ptx-main"><div id="ptx-content" class="ptx-content"><section class="section" id="sec-statistical-testing"><h2 class="heading hide-type">
<span class="type">Section</span><span class="space"> </span><span class="codenumber">3.6</span><span class="space"> </span><span class="title">Introduction to statistical testing</span>
</h2>
<section class="subsection" id="subsec-confidence-intervals"><h3 class="heading hide-type">
<span class="type">Subsection</span><span class="space"> </span><span class="codenumber">3.6.1</span><span class="space"> </span><span class="title">Confidence intervals</span>
</h3>
<div class="para" id="subsec-confidence-intervals-2">Confidence intervals provide a range of plausible values for a population parameter based on sample data. They help quantify the uncertainty in statistical estimates and are a fundamental tool in inferential statistics.</div>
<section class="paragraphs" id="subsec-confidence-intervals-3"><h4 class="heading"><span class="title">Basic Concept.</span></h4>
<div class="para" id="subsec-confidence-intervals-3-2">A confidence interval consists of:</div>
<ul class="disc" id="subsec-confidence-intervals-3-3">
<li id="subsec-confidence-intervals-3-3-1"><div class="para" id="subsec-confidence-intervals-3-3-1-1">A point estimate (typically a sample statistic like the mean)</div></li>
<li id="subsec-confidence-intervals-3-3-2"><div class="para" id="subsec-confidence-intervals-3-3-2-1">A margin of error (which depends on the desired confidence level and the sample’s variability)</div></li>
</ul>
<div class="para" id="subsec-confidence-intervals-3-4">The general form is: Point Estimate ± Margin of Error</div></section><section class="paragraphs" id="subsec-confidence-intervals-4"><h4 class="heading"><span class="title">Confidence Level.</span></h4>
<div class="para" id="subsec-confidence-intervals-4-2">The confidence level (commonly 95%, but also 90%, 99%, etc.) indicates the reliability of the interval:</div>
<ul class="disc" id="subsec-confidence-intervals-4-3">
<li id="subsec-confidence-intervals-4-3-1"><div class="para" id="subsec-confidence-intervals-4-3-1-1">A 95% confidence interval means that if we were to take many samples and construct a confidence interval from each sample, about 95% of these intervals would contain the true population parameter.</div></li>
<li id="subsec-confidence-intervals-4-3-2"><div class="para" id="subsec-confidence-intervals-4-3-2-1">Higher confidence levels result in wider intervals (more certainty but less precision).</div></li>
<li id="subsec-confidence-intervals-4-3-3"><div class="para" id="subsec-confidence-intervals-4-3-3-1">Lower confidence levels result in narrower intervals (less certainty but more precision).</div></li>
</ul></section><section class="paragraphs" id="subsec-confidence-intervals-5"><h4 class="heading"><span class="title">Calculating Confidence Intervals.</span></h4>
<div class="para" id="subsec-confidence-intervals-5-2">For a population mean with a large sample or known population standard deviation:</div>
<div class="para" id="subsec-confidence-intervals-5-3">CI = x̄ ± z × (σ/√n)</div>
<div class="para" id="subsec-confidence-intervals-5-4">where:</div>
<ul class="disc" id="subsec-confidence-intervals-5-5">
<li id="subsec-confidence-intervals-5-5-1"><div class="para" id="subsec-confidence-intervals-5-5-1-1">x̄ is the sample mean</div></li>
<li id="subsec-confidence-intervals-5-5-2"><div class="para" id="subsec-confidence-intervals-5-5-2-1">z is the critical value from the standard normal distribution (e.g., 1.96 for 95% confidence)</div></li>
<li id="subsec-confidence-intervals-5-5-3"><div class="para" id="subsec-confidence-intervals-5-5-3-1">σ is the population standard deviation (or sample standard deviation s for large samples)</div></li>
<li id="subsec-confidence-intervals-5-5-4"><div class="para" id="subsec-confidence-intervals-5-5-4-1">n is the sample size</div></li>
</ul>
<div class="para" id="subsec-confidence-intervals-5-6">For a population mean with a small sample and unknown population standard deviation:</div>
<div class="para" id="subsec-confidence-intervals-5-7">CI = x̄ ± t × (s/√n)</div>
<div class="para" id="subsec-confidence-intervals-5-8">where t is the critical value from the t-distribution with n-1 degrees of freedom.</div></section><section class="paragraphs" id="subsec-confidence-intervals-6"><h4 class="heading"><span class="title">Interpreting Confidence Intervals.</span></h4>
<div class="para" id="subsec-confidence-intervals-6-2">Common interpretations include:</div>
<ul class="disc" id="subsec-confidence-intervals-6-3">
<li id="subsec-confidence-intervals-6-3-1"><div class="para" id="subsec-confidence-intervals-6-3-1-1">We are [confidence level]% confident that the true population parameter falls within this interval.</div></li>
<li id="subsec-confidence-intervals-6-3-2"><div class="para" id="subsec-confidence-intervals-6-3-2-1">If we were to repeat this sampling process many times, [confidence level]% of the resulting intervals would contain the true parameter.</div></li>
</ul>
<div class="para" id="subsec-confidence-intervals-6-4">Note: The confidence interval does NOT indicate the probability that the parameter falls within the interval, as the parameter is fixed (not random).</div></section><div class="code-box"><pre class="program"><code id="rs-prog-confidence-intervals" class="language-none"># Confidence Interval Examples in R
# Set a seed for reproducibility
set.seed(123)

# Generate a sample from a normal distribution
population_mean &lt;- 100
population_sd &lt;- 15
sample_size &lt;- 30

sample_data &lt;- rnorm(sample_size, mean = population_mean, sd = population_sd)

# Calculate sample statistics
sample_mean &lt;- mean(sample_data)
sample_sd &lt;- sd(sample_data)
standard_error &lt;- sample_sd / sqrt(sample_size)

# Print sample statistics
cat("Sample size:", sample_size, "\n")
cat("Sample mean:", round(sample_mean, 2), "\n")
cat("Sample standard deviation:", round(sample_sd, 2), "\n")
cat("Standard error of the mean:", round(standard_error, 2), "\n")

# Calculate 95% confidence interval using t-distribution
# (appropriate for small samples with unknown population standard deviation)
alpha &lt;- 0.05  # For a 95% confidence level
degrees_of_freedom &lt;- sample_size - 1
t_critical &lt;- qt(1 - alpha/2, df = degrees_of_freedom)

margin_of_error &lt;- t_critical * standard_error
lower_bound &lt;- sample_mean - margin_of_error
upper_bound &lt;- sample_mean + margin_of_error

# Print 95% confidence interval
cat("\n95% Confidence Interval for the Mean:\n")
cat("t-critical value:", round(t_critical, 4), "\n")
cat("Margin of error:", round(margin_of_error, 2), "\n")
cat("Lower bound:", round(lower_bound, 2), "\n")
cat("Upper bound:", round(upper_bound, 2), "\n")
cat("Interval: [", round(lower_bound, 2), ", ", round(upper_bound, 2), "]\n")

# Check if the true population mean falls within our confidence interval
if (population_mean &gt;= lower_bound &amp;&amp; population_mean &lt;= upper_bound) {
 cat("The true population mean (", population_mean, ") falls within the confidence interval.\n")
} else {
 cat("The true population mean (", population_mean, ") does not fall within the confidence interval.\n")
}

# Using built-in R function t.test() to calculate confidence interval
t_test_result &lt;- t.test(sample_data, conf.level = 0.95)
ci_from_t_test &lt;- t_test_result$conf.int

cat("\nConfidence Interval using t.test() function:\n")
cat("Lower bound:", round(ci_from_t_test[1], 2), "\n")
cat("Upper bound:", round(ci_from_t_test[2], 2), "\n")

# Calculate confidence intervals for different confidence levels
confidence_levels &lt;- c(0.90, 0.95, 0.99)

cat("\nComparing Confidence Intervals for Different Confidence Levels:\n")
for (conf_level in confidence_levels) {
 t_critical &lt;- qt(1 - (1 - conf_level)/2, df = degrees_of_freedom)
 margin_of_error &lt;- t_critical * standard_error
 lower_bound &lt;- sample_mean - margin_of_error
 upper_bound &lt;- sample_mean + margin_of_error
 
 cat(conf_level * 100, "% CI: [", round(lower_bound, 2), ", ", 
     round(upper_bound, 2), "] (Width: ", round(upper_bound - lower_bound, 2), ")\n")
}

# Visualize confidence intervals for different confidence levels
# Create a simple plot
plot(1, sample_mean, 
    xlim = c(0.5, 1.5), 
    ylim = c(sample_mean - 4*standard_error, sample_mean + 4*standard_error),
    xlab = "", 
    ylab = "Sample Mean", 
    main = "Confidence Intervals for Different Confidence Levels",
    xaxt = "n",  # No x-axis
    pch = 19)

# Add a horizontal line for the true population mean
abline(h = population_mean, col = "red", lty = 2)

# Add confidence intervals
colors &lt;- c("blue", "green", "purple")
i &lt;- 1

for (conf_level in confidence_levels) {
 t_critical &lt;- qt(1 - (1 - conf_level)/2, df = degrees_of_freedom)
 margin_of_error &lt;- t_critical * standard_error
 lower_bound &lt;- sample_mean - margin_of_error
 upper_bound &lt;- sample_mean + margin_of_error
 
 segments(1, lower_bound, 1, upper_bound, col = colors[i], lwd = 3)
 i &lt;- i + 1
}

# Add a legend
legend("topright", 
      legend = paste0(confidence_levels * 100, "% CI"),
      col = colors,
      lwd = 3,
      bty = "n")

# Add a note about the true population mean
text(0.7, population_mean, "True Population Mean", col = "red", pos = 4)

# Effect of sample size on confidence interval width
# We'll calculate 95% confidence intervals for different sample sizes
sample_sizes &lt;- c(10, 30, 100, 300, 1000)
ci_widths &lt;- numeric(length(sample_sizes))

cat("\nEffect of Sample Size on 95% Confidence Interval Width:\n")
for (i in 1:length(sample_sizes)) {
 n &lt;- sample_sizes[i]
 # Generate a larger sample than we need, then take subsets of different sizes
 if (i == 1) {
   large_sample &lt;- rnorm(1000, mean = population_mean, sd = population_sd)
 }
 
 # Take a subset of the required size
 current_sample &lt;- large_sample[1:n]
 
 # Calculate sample statistics
 current_mean &lt;- mean(current_sample)
 current_sd &lt;- sd(current_sample)
 current_se &lt;- current_sd / sqrt(n)
 
 # Calculate confidence interval
 current_t &lt;- qt(0.975, df = n - 1)
 current_margin &lt;- current_t * current_se
 current_lower &lt;- current_mean - current_margin
 current_upper &lt;- current_mean + current_margin
 
 # Store the width
 ci_widths[i] &lt;- current_upper - current_lower
 
 cat("Sample size ", n, ": CI = [", round(current_lower, 2), ", ", 
     round(current_upper, 2), "] (Width: ", round(ci_widths[i], 2), ")\n")
}

# Plot the relationship between sample size and CI width
plot(sample_sizes, ci_widths, 
    type = "b", 
    log = "x",  # Use log scale for x-axis
    xlab = "Sample Size (log scale)", 
    ylab = "Confidence Interval Width",
    main = "Effect of Sample Size on CI Width",
    col = "blue",
    pch = 19,
    lwd = 2)

# Add a reference line showing the 1/sqrt(n) relationship
# Scale it to match the first point for visual comparison
scaling_factor &lt;- ci_widths[1] * sqrt(sample_sizes[1])
theoretical_widths &lt;- scaling_factor / sqrt(sample_sizes)
lines(sample_sizes, theoretical_widths, col = "red", lty = 2, lwd = 2)

# Add a legend
legend("topright", 
      legend = c("Actual CI Width", "Theoretical 1/sqrt(n) Relationship"),
      col = c("blue", "red"),
      lty = c(1, 2),
      lwd = 2,
      pch = c(19, NA),
      bty = "n")

# Real-world example: Confidence interval for mpg in the mtcars dataset
data(mtcars)

# Calculate the 95% confidence interval for the mean mpg
mpg_test &lt;- t.test(mtcars$mpg, conf.level = 0.95)
mpg_ci &lt;- mpg_test$conf.int

cat("\nReal-world Example: 95% Confidence Interval for Mean MPG in mtcars dataset:\n")
cat("Sample mean:", round(mean(mtcars$mpg), 2), "\n")
cat("95% CI: [", round(mpg_ci[1], 2), ", ", round(mpg_ci[2], 2), "]\n")
cat("Interpretation: We are 95% confident that the true average MPG for the population\n")
cat("of cars represented by this sample is between", round(mpg_ci[1], 2), "and", round(mpg_ci[2], 2), "mpg.\n")

# Calculate confidence intervals for mpg by cylinder count
cat("\nConfidence Intervals for MPG by Number of Cylinders:\n")
# Convert cylinders to a factor
mtcars$cyl_f &lt;- as.factor(mtcars$cyl)

# For each cylinder group
for (cyl in levels(mtcars$cyl_f)) {
 mpg_subset &lt;- mtcars$mpg[mtcars$cyl == cyl]
 cyl_test &lt;- t.test(mpg_subset, conf.level = 0.95)
 cyl_ci &lt;- cyl_test$conf.int
 
 cat(cyl, "cylinders (n =", length(mpg_subset), "):\n")
 cat("  Mean MPG:", round(mean(mpg_subset), 2), "\n")
 cat("  95% CI: [", round(cyl_ci[1], 2), ", ", round(cyl_ci[2], 2), "]\n")
}

# Visualize confidence intervals for mpg by cylinder count
# Calculate means and confidence intervals
cyl_levels &lt;- sort(unique(mtcars$cyl))
cyl_means &lt;- numeric(length(cyl_levels))
cyl_lower &lt;- numeric(length(cyl_levels))
cyl_upper &lt;- numeric(length(cyl_levels))

for (i in 1:length(cyl_levels)) {
 cyl &lt;- cyl_levels[i]
 mpg_subset &lt;- mtcars$mpg[mtcars$cyl == cyl]
 
 cyl_means[i] &lt;- mean(mpg_subset)
 cyl_test &lt;- t.test(mpg_subset, conf.level = 0.95)
 cyl_lower[i] &lt;- cyl_test$conf.int[1]
 cyl_upper[i] &lt;- cyl_test$conf.int[2]
}

# Plot the means with confidence intervals
plot(cyl_levels, cyl_means, 
    type = "p", 
    xlab = "Number of Cylinders", 
    ylab = "Miles Per Gallon",
    main = "Mean MPG by Cylinder Count with 95% Confidence Intervals",
    ylim = c(min(cyl_lower) - 1, max(cyl_upper) + 1),
    pch = 19,
    col = "blue",
    xaxt = "n")  # Turn off x-axis labels

# Add custom x-axis labels
axis(1, at = cyl_levels)

# Add confidence intervals as error bars
arrows(cyl_levels, cyl_lower, cyl_levels, cyl_upper, 
      angle = 90, code = 3, length = 0.1, col = "blue", lwd = 2)

# Add sample size for each group
for (i in 1:length(cyl_levels)) {
 cyl &lt;- cyl_levels[i]
 n &lt;- sum(mtcars$cyl == cyl)
 text(cyl, cyl_lower[i] - 0.8, paste("n =", n), cex = 0.8)
}

# Add another perspective - compare with boxplots
boxplot(mpg ~ cyl, 
       data = mtcars,
       main = "MPG Distribution by Cylinder Count",
       xlab = "Number of Cylinders",
       ylab = "Miles Per Gallon",
       col = "lightblue")

# Add the means and confidence intervals to the boxplot
points(1:length(cyl_levels), cyl_means, pch = 19, col = "red")
for (i in 1:length(cyl_levels)) {
 arrows(i, cyl_lower[i], i, cyl_upper[i], 
        angle = 90, code = 3, length = 0.1, col = "red", lwd = 2)
}

# Add a legend
legend("topright", 
      legend = c("Mean", "95% CI"),
      col = c("red", "red"),
      pch = c(19, NA),
      lwd = c(NA, 2),
      bty = "n")
</code></pre></div>
<details id="ex-ci-interpretation" class="exercise exercise-like born-hidden-knowl"><summary class="knowl__link"><h4 class="heading">
<span class="type">Checkpoint</span><span class="space"> </span><span class="codenumber">3.6.1</span><span class="period">.</span><span class="space"> </span><span class="title">Confidence Interval Interpretation.</span>
</h4></summary><article class="exercise exercise-like knowl__content"><div class="para" id="ex-ci-interpretation-2-1">A researcher measures the hemoglobin levels (in g/dL) in a sample of 40 adult women and calculates a 95% confidence interval of [12.3, 13.7] for the population mean.</div></article></details></section><section class="subsection" id="subsec-linear-regression"><h3 class="heading hide-type">
<span class="type">Subsection</span><span class="space"> </span><span class="codenumber">3.6.2</span><span class="space"> </span><span class="title">Linear regression basics</span>
</h3>
<div class="para" id="subsec-linear-regression-2">Linear regression is a fundamental statistical technique used to model the relationship between a dependent variable and one or more independent variables. It assumes a linear relationship between the variables and is widely used for prediction and understanding variable relationships.</div>
<section class="paragraphs" id="subsec-linear-regression-3"><h4 class="heading"><span class="title">Simple Linear Regression.</span></h4>
<div class="para" id="subsec-linear-regression-3-2">Simple linear regression models the relationship between two variables:</div>
<div class="para" id="subsec-linear-regression-3-3">y = β₀ + β₁x + ε</div>
<div class="para" id="subsec-linear-regression-3-4">where:</div>
<ul class="disc" id="subsec-linear-regression-3-5">
<li id="subsec-linear-regression-3-5-1"><div class="para" id="subsec-linear-regression-3-5-1-1">y is the dependent (outcome) variable</div></li>
<li id="subsec-linear-regression-3-5-2"><div class="para" id="subsec-linear-regression-3-5-2-1">x is the independent (predictor) variable</div></li>
<li id="subsec-linear-regression-3-5-3"><div class="para" id="subsec-linear-regression-3-5-3-1">β₀ is the y-intercept (value of y when x = 0)</div></li>
<li id="subsec-linear-regression-3-5-4"><div class="para" id="subsec-linear-regression-3-5-4-1">β₁ is the slope (change in y for a one-unit change in x)</div></li>
<li id="subsec-linear-regression-3-5-5"><div class="para" id="subsec-linear-regression-3-5-5-1">ε is the error term (random variation not explained by the model)</div></li>
</ul></section><section class="paragraphs" id="subsec-linear-regression-4"><h4 class="heading"><span class="title">Multiple Linear Regression.</span></h4>
<div class="para" id="subsec-linear-regression-4-2">Multiple linear regression extends the model to include multiple independent variables:</div>
<div class="para" id="subsec-linear-regression-4-3">y = β₀ + β₁x₁ + β₂x₂ + ... + βₚxₚ + ε</div>
<div class="para" id="subsec-linear-regression-4-4">where p is the number of independent variables.</div></section><section class="paragraphs" id="subsec-linear-regression-5"><h4 class="heading"><span class="title">Key Concepts in Linear Regression.</span></h4>
<ul class="disc" id="subsec-linear-regression-5-2">
<li id="subsec-linear-regression-5-2-1"><div class="para" id="subsec-linear-regression-5-2-1-1">
<dfn class="terminology">Least Squares Estimation</dfn>: The method used to find the line that minimizes the sum of squared differences between observed and predicted values.</div></li>
<li id="subsec-linear-regression-5-2-2"><div class="para" id="subsec-linear-regression-5-2-2-1">
<dfn class="terminology">Coefficient of Determination (R²)</dfn>: Measures the proportion of variance in the dependent variable explained by the independent variable(s). Ranges from 0 to 1, with higher values indicating better fit.</div></li>
<li id="subsec-linear-regression-5-2-3"><div class="para" id="subsec-linear-regression-5-2-3-1">
<dfn class="terminology">Adjusted R²</dfn>: A modified version of R² that adjusts for the number of predictors, making it more suitable for comparing models with different numbers of variables.</div></li>
<li id="subsec-linear-regression-5-2-4"><div class="para" id="subsec-linear-regression-5-2-4-1">
<dfn class="terminology">Residuals</dfn>: The differences between observed and predicted values, used to assess model fit and check assumptions.</div></li>
<li id="subsec-linear-regression-5-2-5"><div class="para" id="subsec-linear-regression-5-2-5-1">
<dfn class="terminology">Standard Error</dfn>: Measures the variability of the coefficient estimates, used for hypothesis testing and confidence intervals.</div></li>
<li id="subsec-linear-regression-5-2-6"><div class="para" id="subsec-linear-regression-5-2-6-1">
<dfn class="terminology">t-statistic and p-value</dfn>: Used to test whether a coefficient is significantly different from zero.</div></li>
</ul></section><section class="paragraphs" id="subsec-linear-regression-6"><h4 class="heading"><span class="title">Assumptions of Linear Regression.</span></h4>
<ul class="disc" id="subsec-linear-regression-6-2">
<li id="subsec-linear-regression-6-2-1"><div class="para" id="subsec-linear-regression-6-2-1-1">
<dfn class="terminology">Linearity</dfn>: The relationship between the independent and dependent variables is linear.</div></li>
<li id="subsec-linear-regression-6-2-2"><div class="para" id="subsec-linear-regression-6-2-2-1">
<dfn class="terminology">Independence</dfn>: The observations are independent of each other.</div></li>
<li id="subsec-linear-regression-6-2-3"><div class="para" id="subsec-linear-regression-6-2-3-1">
<dfn class="terminology">Homoscedasticity</dfn>: The variance of the errors is constant across all levels of the independent variables.</div></li>
<li id="subsec-linear-regression-6-2-4"><div class="para" id="subsec-linear-regression-6-2-4-1">
<dfn class="terminology">Normality</dfn>: The errors are normally distributed.</div></li>
<li id="subsec-linear-regression-6-2-5"><div class="para" id="subsec-linear-regression-6-2-5-1">
<dfn class="terminology">No multicollinearity</dfn> (for multiple regression): The independent variables are not highly correlated with each other.</div></li>
</ul></section><div class="code-box"><pre class="program"><code id="rs-prog-linear-regression" class="language-none"># Linear Regression Examples in R
# Load necessary data
data(mtcars)

# Simple Linear Regression: MPG vs. Weight
# Fit the model
model1 &lt;- lm(mpg ~ wt, data = mtcars)

# Display the model summary
summary(model1)

# Extract key components
coefficients &lt;- coef(model1)
intercept &lt;- coefficients[1]
slope &lt;- coefficients[2]

cat("Simple Linear Regression: MPG vs. Weight\n")
cat("Equation: MPG =", round(intercept, 2), "+", round(slope, 2), "× Weight\n")
cat("Interpretation: For each additional 1,000 lbs of weight,\n")
cat("                MPG decreases by approximately", abs(round(slope, 2)), "units.\n\n")

# R-squared and adjusted R-squared
r_squared &lt;- summary(model1)$r.squared
adj_r_squared &lt;- summary(model1)$adj.r.squared

cat("R-squared:", round(r_squared, 3), "\n")
cat("Adjusted R-squared:", round(adj_r_squared, 3), "\n")
cat("Interpretation: About", round(r_squared * 100), "% of the variation in MPG\n")
cat("                can be explained by the weight of the car.\n\n")

# Confidence intervals for coefficients
conf_intervals &lt;- confint(model1, level = 0.95)
cat("95% Confidence Intervals for Coefficients:\n")
print(round(conf_intervals, 3))

# Plot the data with the regression line
plot(mtcars$wt, mtcars$mpg,
    main = "MPG vs. Weight with Regression Line",
    xlab = "Weight (1000 lbs)",
    ylab = "Miles Per Gallon",
    pch = 19,
    col = "blue")

# Add the regression line
abline(model1, col = "red", lwd = 2)

# Add equation and R-squared to the plot
text(4, 30, paste("MPG =", round(intercept, 2), "+", round(slope, 2), "× Weight"), pos = 4)
text(4, 28, paste("R² =", round(r_squared, 3)), pos = 4)

# Add confidence bands for the regression line
# First, create a sequence of weight values
weight_seq &lt;- seq(min(mtcars$wt), max(mtcars$wt), length.out = 100)

# Predict MPG for these weights with confidence intervals
predictions &lt;- predict(model1, newdata = data.frame(wt = weight_seq),
                     interval = "confidence", level = 0.95)

# Add the confidence bands
lines(weight_seq, predictions[, "lwr"], col = "blue", lty = 2)
lines(weight_seq, predictions[, "upr"], col = "blue", lty = 2)

# Add a legend
legend("topright", 
      legend = c("Data", "Regression Line", "95% Confidence Bands"),
      col = c("blue", "red", "blue"),
      pch = c(19, NA, NA),
      lty = c(NA, 1, 2),
      lwd = c(NA, 2, 1),
      bty = "n")

# Residual Analysis
residuals &lt;- residuals(model1)
fitted_values &lt;- fitted(model1)

# Create residual plots
par(mfrow = c(2, 2))

# Residuals vs. Fitted Values
plot(fitted_values, residuals,
    main = "Residuals vs. Fitted Values",
    xlab = "Fitted Values",
    ylab = "Residuals",
    pch = 19,
    col = "blue")
abline(h = 0, col = "red", lwd = 2, lty = 2)

# Normal Q-Q Plot of Residuals
qqnorm(residuals, main = "Normal Q-Q Plot of Residuals")
qqline(residuals, col = "red", lwd = 2)

# Scale-Location Plot (sqrt of standardized residuals vs. fitted values)
plot(fitted_values, sqrt(abs(residuals/sd(residuals))),
    main = "Scale-Location Plot",
    xlab = "Fitted Values",
    ylab = "Sqrt of Standardized Residuals",
    pch = 19,
    col = "blue")
lines(lowess(fitted_values, sqrt(abs(residuals/sd(residuals)))), col = "red", lwd = 2)

# Residuals vs. Leverage
plot(hatvalues(model1), residuals,
    main = "Residuals vs. Leverage",
    xlab = "Leverage",
    ylab = "Residuals",
    pch = 19,
    col = "blue")
abline(h = 0, col = "red", lwd = 2, lty = 2)

# Reset plotting parameters
par(mfrow = c(1, 1))

# Multiple Linear Regression: MPG vs. Weight and Horsepower
# Fit the model
model2 &lt;- lm(mpg ~ wt + hp, data = mtcars)

# Display the model summary
summary(model2)

# Extract key components
coefficients2 &lt;- coef(model2)
intercept2 &lt;- coefficients2[1]
wt_coef &lt;- coefficients2[2]
hp_coef &lt;- coefficients2[3]

cat("\nMultiple Linear Regression: MPG vs. Weight and Horsepower\n")
cat("Equation: MPG =", round(intercept2, 2), "+", 
    round(wt_coef, 2), "× Weight +", 
    round(hp_coef, 2), "× Horsepower\n")
cat("Interpretation:\n")
cat("- For each additional 1,000 lbs of weight, MPG decreases by approximately", 
    abs(round(wt_coef, 2)), "units, holding horsepower constant.\n")
cat("- For each additional horsepower, MPG decreases by approximately", 
    abs(round(hp_coef, 2)), "units, holding weight constant.\n\n")

# R-squared and adjusted R-squared
r_squared2 &lt;- summary(model2)$r.squared
adj_r_squared2 &lt;- summary(model2)$adj.r.squared

cat("R-squared:", round(r_squared2, 3), "\n")
cat("Adjusted R-squared:", round(adj_r_squared2, 3), "\n")
cat("Interpretation: About", round(r_squared2 * 100), "% of the variation in MPG\n")
cat("                can be explained by weight and horsepower together.\n\n")

# Confidence intervals for coefficients
conf_intervals2 &lt;- confint(model2, level = 0.95)
cat("95% Confidence Intervals for Coefficients:\n")
print(round(conf_intervals2, 3))

# Model comparison
cat("\nModel Comparison: Simple vs. Multiple Regression\n")
anova_result &lt;- anova(model1, model2)
print(anova_result)

cat("\nInterpretation: The p-value in the ANOVA table indicates whether adding horsepower\n")
cat("significantly improves the model compared to using weight alone.\n")
cat("A small p-value (&lt; 0.05) suggests that the multiple regression model is preferable.\n\n")

# Create a 3D visualization of the multiple regression model
# (In a normal R environment, you would use packages like 'plotly' or 'rgl')
# Here, we'll create a 2D visualization with color for the third dimension

# Create a grid of weight and horsepower values
weight_grid &lt;- seq(min(mtcars$wt), max(mtcars$wt), length.out = 30)
hp_grid &lt;- seq(min(mtcars$hp), max(mtcars$hp), length.out = 30)
grid_data &lt;- expand.grid(wt = weight_grid, hp = hp_grid)

# Predict MPG for each combination
grid_data$mpg_pred &lt;- predict(model2, newdata = grid_data)

# Create a scatter plot with contour lines
# Plot the actual data points
plot(mtcars$wt, mtcars$hp, 
     main = "Multiple Regression: MPG as a Function of Weight and Horsepower",
     xlab = "Weight (1000 lbs)",
     ylab = "Horsepower",
     pch = 19,
     col = "blue",
     cex = mtcars$mpg / 10)  # Size proportional to actual MPG

# Add contour lines for predicted MPG
contour(weight_grid, hp_grid, 
        matrix(grid_data$mpg_pred, nrow = length(weight_grid)), 
        add = TRUE,
        levels = seq(10, 35, by = 5),
        col = "red",
        lwd = 2,
        labcex = 0.8)

# Add a legend
legend("topright", 
       legend = c("Car (size proportional to MPG)", "MPG contour lines"),
       col = c("blue", "red"),
       pch = c(19, NA),
       lty = c(NA, 1),
       lwd = c(NA, 2),
       bty = "n")

# Check for multicollinearity
cat("\nChecking for Multicollinearity:\n")
cat("Correlation between Weight and Horsepower:", round(cor(mtcars$wt, mtcars$hp), 3), "\n")
if(abs(cor(mtcars$wt, mtcars$hp)) &gt; 0.7) {
  cat("Note: The high correlation between weight and horsepower indicates\n")
  cat("potential multicollinearity, which could affect the stability and\n")
  cat("interpretation of the regression coefficients.\n\n")
}

# Calculate Variance Inflation Factor (VIF) manually
# VIF = 1/(1-R²), where R² is from regressing the predictor on other predictors
wt_on_hp_model &lt;- lm(wt ~ hp, data = mtcars)
hp_on_wt_model &lt;- lm(hp ~ wt, data = mtcars)

wt_vif &lt;- 1 / (1 - summary(wt_on_hp_model)$r.squared)
hp_vif &lt;- 1 / (1 - summary(hp_on_wt_model)$r.squared)

cat("Variance Inflation Factors (VIF):\n")
cat("- Weight:", round(wt_vif, 2), "\n")
cat("- Horsepower:", round(hp_vif, 2), "\n")
cat("VIF values greater than 5-10 indicate problematic multicollinearity.\n\n")

# Reset plotting parameters
par(mfrow = c(1, 1))

# Summary of linear regression analysis
cat("\nSummary of Linear Regression Analysis:\n")
cat("------------------------------------\n\n")

cat("Linear regression is a powerful and interpretable modeling technique that allows us\n")
cat("to understand and quantify relationships between variables. In our analysis of the\n")
cat("mtcars dataset, we found that both car weight and horsepower are significant\n")
cat("predictors of fuel efficiency (MPG).\n\n")

cat("The simple linear regression model using only weight explained", 
    round(r_squared * 100), "% of the\n")
cat("variation in MPG, while the multiple regression model including both weight and\n")
cat("horsepower explained", round(r_squared2 * 100), "% of the variation.\n\n")

cat("The multiple regression analysis revealed that, holding other factors constant:\n")
cat("1. Each additional 1,000 lbs of weight is associated with a", 
    abs(round(wt_coef, 2)), "MPG decrease\n")
cat("2. Each additional horsepower is associated with a", 
    abs(round(hp_coef, 2)), "MPG decrease\n\n")

cat("These findings can help car manufacturers understand the trade-offs between\n")
cat("performance characteristics and fuel efficiency. For example, reducing vehicle\n")
cat("weight appears to be an effective strategy for improving MPG.\n\n")

cat("However, it's important to note that our analysis has limitations. The mtcars\n")
cat("dataset is relatively small (32 observations) and from the 1970s, so the\n")
cat("relationships may not fully apply to modern vehicles with advanced technologies.\n")
cat("Additionally, we should be cautious about causal interpretation, as other factors\n")
cat("not included in our model might influence both our predictors and MPG.\n\n")

cat("Further analysis could explore additional predictor variables, interaction effects,\n")
cat("and non-linear relationships to build a more comprehensive model of fuel efficiency.\n")
</code></pre></div>
<details id="ex-multi-regression" class="exercise exercise-like born-hidden-knowl"><summary class="knowl__link"><h4 class="heading">
<span class="type">Checkpoint</span><span class="space"> </span><span class="codenumber">3.6.2</span><span class="period">.</span><span class="space"> </span><span class="title">Multiple Regression Analysis.</span>
</h4></summary><article class="exercise exercise-like knowl__content"><div class="para" id="ex-multi-regression-2-1">Based on the multiple regression model explored above, answer the following questions:</div></article></details></section><section class="subsection" id="subsec-hypothesis-testing"><h3 class="heading hide-type">
<span class="type">Subsection</span><span class="space"> </span><span class="codenumber">3.6.3</span><span class="space"> </span><span class="title">Hypothesis testing basics</span>
</h3>
<div class="para" id="subsec-hypothesis-testing-2">Hypothesis testing is a fundamental statistical method used to make inferences about populations based on sample data. It provides a framework for deciding whether experimental or observational data support a particular claim about a population parameter.</div>
<section class="paragraphs" id="subsec-hypothesis-testing-3"><h4 class="heading"><span class="title">The Hypothesis Testing Framework.</span></h4>
<div class="para" id="subsec-hypothesis-testing-3-2">The general process of hypothesis testing follows these steps:</div>
<ol class="decimal" id="subsec-hypothesis-testing-3-3">
<li id="subsec-hypothesis-testing-3-3-1"><div class="para" id="subsec-hypothesis-testing-3-3-1-1">State the null hypothesis (H₀) and alternative hypothesis (H₁ or Hₐ)</div></li>
<li id="subsec-hypothesis-testing-3-3-2"><div class="para" id="subsec-hypothesis-testing-3-3-2-1">Choose a significance level (α) - commonly 0.05</div></li>
<li id="subsec-hypothesis-testing-3-3-3"><div class="para" id="subsec-hypothesis-testing-3-3-3-1">Collect data and calculate a test statistic</div></li>
<li id="subsec-hypothesis-testing-3-3-4"><div class="para" id="subsec-hypothesis-testing-3-3-4-1">Calculate the p-value or compare the test statistic to critical values</div></li>
<li id="subsec-hypothesis-testing-3-3-5"><div class="para" id="subsec-hypothesis-testing-3-3-5-1">Make a decision: reject or fail to reject the null hypothesis</div></li>
<li id="subsec-hypothesis-testing-3-3-6"><div class="para" id="subsec-hypothesis-testing-3-3-6-1">Interpret the results in the context of the original question</div></li>
</ol></section><section class="paragraphs" id="subsec-hypothesis-testing-4"><h4 class="heading"><span class="title">Key Concepts in Hypothesis Testing.</span></h4>
<ul class="disc" id="subsec-hypothesis-testing-4-2">
<li id="subsec-hypothesis-testing-4-2-1"><div class="para" id="subsec-hypothesis-testing-4-2-1-1">
<dfn class="terminology">Null Hypothesis (H₀)</dfn>: A statement of no effect, no difference, or no relationship. It’s the default position that is assumed to be true until evidence suggests otherwise.</div></li>
<li id="subsec-hypothesis-testing-4-2-2"><div class="para" id="subsec-hypothesis-testing-4-2-2-1">
<dfn class="terminology">Alternative Hypothesis (H₁ or Hₐ)</dfn>: A statement that contradicts the null hypothesis and represents what the researcher is trying to establish.</div></li>
<li id="subsec-hypothesis-testing-4-2-3"><div class="para" id="subsec-hypothesis-testing-4-2-3-1">
<dfn class="terminology">Significance Level (α)</dfn>: The threshold probability for rejecting the null hypothesis, typically set at 0.05 (5%). It represents the risk of making a Type I error.</div></li>
<li id="subsec-hypothesis-testing-4-2-4"><div class="para" id="subsec-hypothesis-testing-4-2-4-1">
<dfn class="terminology">p-value</dfn>: The probability of obtaining a test statistic at least as extreme as the one observed, assuming the null hypothesis is true. A smaller p-value indicates stronger evidence against the null hypothesis.</div></li>
<li id="subsec-hypothesis-testing-4-2-5"><div class="para" id="subsec-hypothesis-testing-4-2-5-1">
<dfn class="terminology">Type I Error</dfn>: Rejecting a true null hypothesis (false positive).</div></li>
<li id="subsec-hypothesis-testing-4-2-6"><div class="para" id="subsec-hypothesis-testing-4-2-6-1">
<dfn class="terminology">Type II Error</dfn>: Failing to reject a false null hypothesis (false negative).</div></li>
<li id="subsec-hypothesis-testing-4-2-7"><div class="para" id="subsec-hypothesis-testing-4-2-7-1">
<dfn class="terminology">Power</dfn>: The probability of correctly rejecting a false null hypothesis. Power increases with sample size and effect size.</div></li>
</ul></section><section class="paragraphs" id="subsec-hypothesis-testing-5"><h4 class="heading"><span class="title">Common Hypothesis Tests.</span></h4>
<ul class="disc" id="subsec-hypothesis-testing-5-2">
<li id="subsec-hypothesis-testing-5-2-1"><div class="para logical" id="subsec-hypothesis-testing-5-2-1-1">
<div class="para">
<dfn class="terminology">t-test</dfn>: Used to compare means.</div>
<ul class="circle" id="subsec-hypothesis-testing-5-2-1-1-2">
<li id="subsec-hypothesis-testing-5-2-1-1-2-1"><div class="para" id="subsec-hypothesis-testing-5-2-1-1-2-1-1">One-sample t-test: Compares a sample mean to a known population mean.</div></li>
<li id="subsec-hypothesis-testing-5-2-1-1-2-2"><div class="para" id="subsec-hypothesis-testing-5-2-1-1-2-2-1">Independent samples t-test: Compares means of two independent groups.</div></li>
<li id="subsec-hypothesis-testing-5-2-1-1-2-3"><div class="para" id="subsec-hypothesis-testing-5-2-1-1-2-3-1">Paired samples t-test: Compares means of two related groups (before/after, matched pairs).</div></li>
</ul>
</div></li>
<li id="subsec-hypothesis-testing-5-2-2"><div class="para" id="subsec-hypothesis-testing-5-2-2-1">
<dfn class="terminology">ANOVA (Analysis of Variance)</dfn>: Extends the t-test to compare means across more than two groups.</div></li>
<li id="subsec-hypothesis-testing-5-2-3"><div class="para" id="subsec-hypothesis-testing-5-2-3-1">
<dfn class="terminology">Chi-Square Test</dfn>: Used to test relationships between categorical variables.</div></li>
<li id="subsec-hypothesis-testing-5-2-4"><div class="para" id="subsec-hypothesis-testing-5-2-4-1">
<dfn class="terminology">Correlation Test</dfn>: Tests the significance of a correlation coefficient.</div></li>
<li id="subsec-hypothesis-testing-5-2-5"><div class="para" id="subsec-hypothesis-testing-5-2-5-1">
<dfn class="terminology">Non-parametric Tests</dfn>: Used when data do not meet the assumptions of parametric tests (e.g., Mann-Whitney U, Wilcoxon rank-sum).</div></li>
</ul></section><div class="code-box"><pre class="program"><code id="rs-prog-hypothesis-testing" class="language-none"># Hypothesis Testing Examples in R
# Set a seed for reproducibility
set.seed(123)

# Example 1: One-sample t-test
# Suppose we want to test if the mean mpg of cars is different from 20 mpg
data(mtcars)

# Perform the one-sample t-test
t_test_one_sample &lt;- t.test(mtcars$mpg, mu = 20)

# Display the results
cat("One-sample t-test:\n")
print(t_test_one_sample)

# Explain the results
cat("\nInterpretation:\n")
if (t_test_one_sample$p.value &lt; 0.05) {
  cat("The p-value (", round(t_test_one_sample$p.value, 4), ") is less than 0.05, so we reject the null hypothesis.\n")
  cat("There is sufficient evidence to conclude that the mean MPG is different from 20.\n")
} else {
  cat("The p-value (", round(t_test_one_sample$p.value, 4), ") is greater than 0.05, so we fail to reject the null hypothesis.\n")
  cat("There is insufficient evidence to conclude that the mean MPG is different from 20.\n")
}

# Example 2: Two-sample t-test (independent samples)
# Compare MPG between automatic and manual transmission cars
automatic &lt;- mtcars$mpg[mtcars$am == 0]
manual &lt;- mtcars$mpg[mtcars$am == 1]

# Perform the two-sample t-test
t_test_two_sample &lt;- t.test(manual, automatic)

# Display the results
cat("\nTwo-sample t-test (Manual vs Automatic Transmission):\n")
print(t_test_two_sample)

# Visualization of the two groups
boxplot(mpg ~ am, data = mtcars,
        main = "MPG by Transmission Type",
        xlab = "Transmission (0 = Automatic, 1 = Manual)",
        ylab = "Miles Per Gallon",
        col = c("lightblue", "lightgreen"))

# Add the means to the boxplot
points(c(1, 2), c(mean(automatic), mean(manual)), pch = 19, col = "red")

# Example 3: Paired t-test
# Let's simulate before-after measurements
set.seed(456)
before_treatment &lt;- rnorm(20, mean = 10, sd = 2)
after_treatment &lt;- before_treatment + rnorm(20, mean = 1.5, sd = 1)  # Effect of +1.5 with some noise

# Perform the paired t-test
t_test_paired &lt;- t.test(after_treatment, before_treatment, paired = TRUE)

# Display the results
cat("\nPaired t-test (After vs Before Treatment):\n")
print(t_test_paired)

# Visualization of the paired data
plot(1:20, before_treatment, type = "p", col = "blue", pch = 19,
     ylim = c(min(c(before_treatment, after_treatment)) - 1, max(c(before_treatment, after_treatment)) + 1),
     xlab = "Subject", ylab = "Measurement",
     main = "Before-After Treatment Comparison")
points(1:20, after_treatment, col = "red", pch = 19)
legend("topleft", legend = c("Before", "After"), col = c("blue", "red"), pch = 19)

# Connect the paired points with lines
for (i in 1:20) {
  segments(i, before_treatment[i], i, after_treatment[i], col = "gray")
}

# Example 4: Chi-square test of independence
# Create a contingency table (example: gender vs. preference)
gender &lt;- factor(c(rep("Male", 50), rep("Female", 50)))
preference &lt;- factor(c(rep("Option A", 30), rep("Option B", 20), 
                      rep("Option A", 20), rep("Option B", 30)))

# Create a contingency table
contingency_table &lt;- table(gender, preference)
print(contingency_table)

# Perform the chi-square test
chi_sq_test &lt;- chisq.test(contingency_table)

# Display the results
cat("\nChi-square test of independence:\n")
print(chi_sq_test)

# Visualize the contingency table
barplot(contingency_table, beside = TRUE, legend = TRUE,
        main = "Preference by Gender",
        xlab = "Preference",
        ylab = "Count",
        col = c("lightblue", "lightpink"))

# Example 5: Correlation test
# Test if there's a significant correlation between weight and MPG
cor_test &lt;- cor.test(mtcars$wt, mtcars$mpg)

# Display the results
cat("\nCorrelation test (Weight vs MPG):\n")
print(cor_test)

# Visualize the relationship
plot(mtcars$wt, mtcars$mpg,
     main = "Weight vs. MPG with Correlation Results",
     xlab = "Weight (1000 lbs)",
     ylab = "Miles Per Gallon",
     pch = 19,
     col = "blue")

# Add the regression line
abline(lm(mpg ~ wt, data = mtcars), col = "red", lwd = 2)

# Add the correlation value to the plot
text(4, 30, paste("r =", round(cor_test$estimate, 2),
                 "\np-value =", round(cor_test$p.value, 5)),
     pos = 4)
</code></pre></div>
<details id="ex-hypothesis-testing" class="exercise exercise-like born-hidden-knowl"><summary class="knowl__link"><h4 class="heading">
<span class="type">Checkpoint</span><span class="space"> </span><span class="codenumber">3.6.3</span><span class="period">.</span><span class="space"> </span><span class="title">Hypothesis Testing Practice.</span>
</h4></summary><article class="exercise exercise-like knowl__content"><div class="para" id="ex-hypothesis-testing-2-1">Answer the following questions about hypothesis testing:</div></article></details></section><section class="section" id="sec-anova-basics"><h3 class="heading hide-type">
<span class="type">Section</span><span class="space"> </span><span class="codenumber">3.6.1</span><span class="space"> </span><span class="title">ANOVA basics</span>
</h3>
<div class="para" id="sec-anova-basics-2">Analysis of Variance (ANOVA) is a statistical method used to compare means across three or more groups. It extends the t-test concept to situations with multiple groups, helping to determine if there are any statistically significant differences between the means of independent groups.</div>
<section class="paragraphs" id="sec-anova-basics-3"><h4 class="heading"><span class="title">Basic Concepts of ANOVA.</span></h4>
<div class="para" id="sec-anova-basics-3-2">ANOVA works by analyzing the variance in the data and partitioning it into different sources:</div>
<ul class="disc" id="sec-anova-basics-3-3">
<li id="sec-anova-basics-3-3-1"><div class="para" id="sec-anova-basics-3-3-1-1">
<dfn class="terminology">Between-Group Variance</dfn>: Variation due to differences between group means (treatment effect)</div></li>
<li id="sec-anova-basics-3-3-2"><div class="para" id="sec-anova-basics-3-3-2-1">
<dfn class="terminology">Within-Group Variance</dfn>: Variation due to differences within each group (error or residual variance)</div></li>
</ul>
<div class="para" id="sec-anova-basics-3-4">The F-statistic is then calculated as the ratio of between-group variance to within-group variance. A large F-value suggests that the between-group variance is more significant than what would be expected by chance, indicating differences between group means.</div></section><section class="paragraphs" id="sec-anova-basics-4"><h4 class="heading"><span class="title">Types of ANOVA.</span></h4>
<ul class="disc" id="sec-anova-basics-4-2">
<li id="sec-anova-basics-4-2-1"><div class="para" id="sec-anova-basics-4-2-1-1">
<dfn class="terminology">One-Way ANOVA</dfn>: Analyzes the effect of a single factor (independent variable) on a continuous outcome.</div></li>
<li id="sec-anova-basics-4-2-2"><div class="para" id="sec-anova-basics-4-2-2-1">
<dfn class="terminology">Two-Way ANOVA</dfn>: Examines the effect of two factors simultaneously, including their interaction.</div></li>
<li id="sec-anova-basics-4-2-3"><div class="para" id="sec-anova-basics-4-2-3-1">
<dfn class="terminology">Repeated Measures ANOVA</dfn>: Used when the same subjects are measured multiple times (like in before-after designs).</div></li>
<li id="sec-anova-basics-4-2-4"><div class="para" id="sec-anova-basics-4-2-4-1">
<dfn class="terminology">MANOVA (Multivariate ANOVA)</dfn>: Extends ANOVA to cases with multiple dependent variables.</div></li>
<li id="sec-anova-basics-4-2-5"><div class="para" id="sec-anova-basics-4-2-5-1">
<dfn class="terminology">ANCOVA (Analysis of Covariance)</dfn>: Incorporates continuous control variables (covariates) into the ANOVA model.</div></li>
</ul></section><section class="paragraphs" id="sec-anova-basics-5"><h4 class="heading"><span class="title">ANOVA Assumptions.</span></h4>
<div class="para" id="sec-anova-basics-5-2">For valid ANOVA results, several assumptions should be met:</div>
<ul class="disc" id="sec-anova-basics-5-3">
<li id="sec-anova-basics-5-3-1"><div class="para" id="sec-anova-basics-5-3-1-1">
<dfn class="terminology">Independence</dfn>: Observations are independent of each other.</div></li>
<li id="sec-anova-basics-5-3-2"><div class="para" id="sec-anova-basics-5-3-2-1">
<dfn class="terminology">Normality</dfn>: The data within each group are normally distributed.</div></li>
<li id="sec-anova-basics-5-3-3"><div class="para" id="sec-anova-basics-5-3-3-1">
<dfn class="terminology">Homogeneity of Variance</dfn>: The variance is similar across all groups (homoscedasticity).</div></li>
</ul></section><section class="paragraphs" id="sec-anova-basics-6"><h4 class="heading"><span class="title">Post-hoc Tests.</span></h4>
<div class="para" id="sec-anova-basics-6-2">ANOVA tells us if there are significant differences among groups, but it doesn’t tell us which specific groups differ from each other. Post-hoc tests are used to make pairwise comparisons after a significant ANOVA result:</div>
<ul class="disc" id="sec-anova-basics-6-3">
<li id="sec-anova-basics-6-3-1"><div class="para" id="sec-anova-basics-6-3-1-1">
<dfn class="terminology">Tukey’s HSD (Honestly Significant Difference)</dfn>: Controls the family-wise error rate and is commonly used for all pairwise comparisons.</div></li>
<li id="sec-anova-basics-6-3-2"><div class="para" id="sec-anova-basics-6-3-2-1">
<dfn class="terminology">Bonferroni Correction</dfn>: A conservative approach that adjusts the significance level by dividing it by the number of comparisons.</div></li>
<li id="sec-anova-basics-6-3-3"><div class="para" id="sec-anova-basics-6-3-3-1">
<dfn class="terminology">Scheffe’s Method</dfn>: A flexible but conservative test that allows for complex comparisons.</div></li>
<li id="sec-anova-basics-6-3-4"><div class="para" id="sec-anova-basics-6-3-4-1">
<dfn class="terminology">Dunnett’s Test</dfn>: Used when comparing multiple groups to a single control group.</div></li>
</ul></section><div class="code-box"><pre class="program"><code id="rs-prog-anova" class="language-none"># ANOVA Examples in R
# Load necessary data
data(iris)
data(mtcars)

# Example 1: One-Way ANOVA
# Compare sepal lengths across three iris species
one_way_anova &lt;- aov(Sepal.Length ~ Species, data = iris)

# Display the ANOVA summary
cat("One-Way ANOVA: Comparing Sepal Length Across Iris Species\n")
print(summary(one_way_anova))

# Visualize the data
boxplot(Sepal.Length ~ Species, data = iris,
        main = "Sepal Length by Species",
        xlab = "Species",
        ylab = "Sepal Length (cm)",
        col = c("lightpink", "lightblue", "lightgreen"))

# Add the means to the boxplot
species_means &lt;- tapply(iris$Sepal.Length, iris$Species, mean)
points(1:3, species_means, pch = 19, col = "red", cex = 1.2)

# Post-hoc analysis: Tukey's HSD test
cat("\nTukey's HSD Test for Multiple Comparisons:\n")
tukey_result &lt;- TukeyHSD(one_way_anova)
print(tukey_result)

# Plot the Tukey HSD results
plot(tukey_result, las = 1)

# Example 2: Two-Way ANOVA
# We'll use the mtcars dataset to examine the effects of
# number of cylinders (cyl) and transmission type (am) on mpg

# First, ensure the factors are properly formatted
mtcars$cyl_f &lt;- as.factor(mtcars$cyl)
mtcars$am_f &lt;- as.factor(mtcars$am)
levels(mtcars$am_f) &lt;- c("Automatic", "Manual")

# Perform the Two-Way ANOVA
two_way_anova &lt;- aov(mpg ~ cyl_f * am_f, data = mtcars)

# Display the ANOVA summary
cat("\nTwo-Way ANOVA: Effect of Cylinders and Transmission on MPG\n")
print(summary(two_way_anova))

# Create an interaction plot
interaction.plot(mtcars$cyl_f, mtcars$am_f, mtcars$mpg,
                 legend = TRUE,
                 type = "b",
                 col = c("red", "blue"),
                 pch = c(19, 21),
                 main = "Interaction Plot: Cylinders × Transmission on MPG",
                 xlab = "Number of Cylinders",
                 ylab = "Mean Miles Per Gallon",
                 trace.label = "Transmission Type")

# Creating a more detailed visualization with boxplots
par(mfrow = c(1, 1))
boxplot(mpg ~ am_f * cyl_f, data = mtcars,
        col = c("lightpink", "lightblue"),
        main = "MPG by Transmission Type and Number of Cylinders",
        xlab = "Transmission Type and Cylinders",
        ylab = "Miles Per Gallon")

# Check ANOVA assumptions
# 1. Normality of residuals
par(mfrow = c(2, 2))
plot(one_way_anova)
par(mfrow = c(1, 1))

# 2. Homogeneity of variances - Levene's test
install.packages("car")  # If not already installed
library(car)
leveneTest(Sepal.Length ~ Species, data = iris)

# Non-parametric alternative to ANOVA
# Kruskal-Wallis test (when ANOVA assumptions are violated)
kruskal_result &lt;- kruskal.test(Sepal.Length ~ Species, data = iris)
cat("\nKruskal-Wallis Test (Non-parametric alternative to ANOVA):\n")
print(kruskal_result)

# Effect Size for ANOVA
# Eta-squared calculation
# Eta-squared = SSbetween / SStotal
anova_summary &lt;- summary(one_way_anova)
ss_between &lt;- anova_summary[[1]]["Species", "Sum Sq"]
ss_total &lt;- ss_between + anova_summary[[1]]["Residuals", "Sum Sq"]
eta_squared &lt;- ss_between / ss_total
cat("\nEffect Size (Eta-squared):", round(eta_squared, 3), "\n")
cat("Interpretation: Approximately", round(eta_squared * 100), "% of the variance\n")
cat("in sepal length can be attributed to species differences.\n")

# Create a means plot with error bars
species_means &lt;- tapply(iris$Sepal.Length, iris$Species, mean)
species_se &lt;- tapply(iris$Sepal.Length, iris$Species,
                     function(x) sd(x)/sqrt(length(x)))

# Create a bar plot of means
bar_positions &lt;- barplot(species_means,
                         col = c("lightpink", "lightblue", "lightgreen"),
                         main = "Mean Sepal Length by Species with 95% CI",
                         xlab = "Species",
                         ylab = "Mean Sepal Length (cm)",
                         ylim = c(0, max(species_means) + 3 * max(species_se)))

# Add error bars (95% confidence intervals)
arrows(bar_positions, species_means - 1.96 * species_se,
       bar_positions, species_means + 1.96 * species_se,
       code = 3, angle = 90, length = 0.1)

# Add sample size
text(bar_positions, 0.5,
     paste("n =", tapply(iris$Sepal.Length, iris$Species, length)),
     cex = 0.8)

# Add post-hoc test results
text(1, species_means[1] + 1.96 * species_se[1] + 0.2, "a", cex = 1.2)
text(2, species_means[2] + 1.96 * species_se[2] + 0.2, "b", cex = 1.2)
text(3, species_means[3] + 1.96 * species_se[3] + 0.2, "c", cex = 1.2)

# Add a note explaining the letters
text(2, max(species_means) + 3 * max(species_se) - 0.5,
     "Different letters indicate\nsignificantly different means\n(Tukey HSD, p &lt; 0.05)",
     cex = 0.8)
</code></pre></div>
<details id="ex-anova-practice" class="exercise exercise-like born-hidden-knowl"><summary class="knowl__link"><h4 class="heading">
<span class="type">Checkpoint</span><span class="space"> </span><span class="codenumber">3.6.1</span><span class="period">.</span><span class="space"> </span><span class="title">ANOVA Practice.</span>
</h4></summary><article class="exercise exercise-like knowl__content"><div class="para" id="ex-anova-practice-2-1">Analyze and interpret the following ANOVA scenarios:</div></article></details></section><section class="section" id="sec-advanced-analysis"><h3 class="heading hide-type">
<span class="type">Section</span><span class="space"> </span><span class="codenumber">3.6.2</span><span class="space"> </span><span class="title">Advanced Analysis and Final Project Work</span>
</h3>
<section class="subsection" id="subsec-prediction-modeling"><h4 class="heading hide-type">
<span class="type">Subsection</span><span class="space"> </span><span class="codenumber">3.6.2.1</span><span class="space"> </span><span class="title">Building simple predictive models</span>
</h4>
<div class="para" id="subsec-prediction-modeling-2">Predictive modeling is a powerful technique for forecasting outcomes based on historical data. In this section, we will explore the fundamentals of building simple predictive models in R, focusing on practical implementation and interpretation.</div>
<section class="paragraphs" id="subsec-prediction-modeling-3"><h5 class="heading"><span class="title">Predictive Modeling Workflow.</span></h5>
<div class="para" id="subsec-prediction-modeling-3-2">The typical workflow for developing predictive models includes:</div>
<ol class="decimal" id="subsec-prediction-modeling-3-3">
<li id="subsec-prediction-modeling-3-3-1"><div class="para" id="subsec-prediction-modeling-3-3-1-1">
<dfn class="terminology">Problem Definition</dfn>: Clearly define what you want to predict and why</div></li>
<li id="subsec-prediction-modeling-3-3-2"><div class="para" id="subsec-prediction-modeling-3-3-2-1">
<dfn class="terminology">Data Preparation</dfn>: Collect, clean, and preprocess the data</div></li>
<li id="subsec-prediction-modeling-3-3-3"><div class="para" id="subsec-prediction-modeling-3-3-3-1">
<dfn class="terminology">Data Splitting</dfn>: Divide data into training and test sets</div></li>
<li id="subsec-prediction-modeling-3-3-4"><div class="para" id="subsec-prediction-modeling-3-3-4-1">
<dfn class="terminology">Model Selection</dfn>: Choose appropriate modeling techniques</div></li>
<li id="subsec-prediction-modeling-3-3-5"><div class="para" id="subsec-prediction-modeling-3-3-5-1">
<dfn class="terminology">Model Training</dfn>: Fit models to the training data</div></li>
<li id="subsec-prediction-modeling-3-3-6"><div class="para" id="subsec-prediction-modeling-3-3-6-1">
<dfn class="terminology">Model Evaluation</dfn>: Assess performance on test data</div></li>
<li id="subsec-prediction-modeling-3-3-7"><div class="para" id="subsec-prediction-modeling-3-3-7-1">
<dfn class="terminology">Model Deployment</dfn>: Implement the model for making predictions</div></li>
</ol></section><section class="paragraphs" id="subsec-prediction-modeling-4"><h5 class="heading"><span class="title">Common Predictive Models.</span></h5>
<div class="para" id="subsec-prediction-modeling-4-2">Several types of models are useful for different prediction tasks:</div>
<ul class="disc" id="subsec-prediction-modeling-4-3">
<li id="subsec-prediction-modeling-4-3-1"><div class="para" id="subsec-prediction-modeling-4-3-1-1">
<dfn class="terminology">Linear Regression</dfn>: Predicts continuous outcomes based on one or more predictor variables</div></li>
<li id="subsec-prediction-modeling-4-3-2"><div class="para" id="subsec-prediction-modeling-4-3-2-1">
<dfn class="terminology">Logistic Regression</dfn>: Predicts binary outcomes (e.g., yes/no, success/failure)</div></li>
<li id="subsec-prediction-modeling-4-3-3"><div class="para" id="subsec-prediction-modeling-4-3-3-1">
<dfn class="terminology">Decision Trees</dfn>: Splits data into branches based on feature values to make predictions</div></li>
<li id="subsec-prediction-modeling-4-3-4"><div class="para" id="subsec-prediction-modeling-4-3-4-1">
<dfn class="terminology">Random Forests</dfn>: Combines multiple decision trees to improve prediction accuracy</div></li>
<li id="subsec-prediction-modeling-4-3-5"><div class="para" id="subsec-prediction-modeling-4-3-5-1">
<dfn class="terminology">Support Vector Machines</dfn>: Finds optimal boundaries to separate different classes</div></li>
<li id="subsec-prediction-modeling-4-3-6"><div class="para" id="subsec-prediction-modeling-4-3-6-1">
<dfn class="terminology">Neural Networks</dfn>: Models complex patterns using interconnected layers of nodes</div></li>
</ul></section><section class="paragraphs" id="subsec-prediction-modeling-5"><h5 class="heading"><span class="title">Model Evaluation Metrics.</span></h5>
<div class="para" id="subsec-prediction-modeling-5-2">Different metrics are used to evaluate model performance depending on the prediction task:</div>
<ul class="disc" id="subsec-prediction-modeling-5-3">
<li id="subsec-prediction-modeling-5-3-1"><div class="para logical" id="subsec-prediction-modeling-5-3-1-1">
<div class="para">
<dfn class="terminology">For Regression Models</dfn>:</div>
<ul class="circle" id="subsec-prediction-modeling-5-3-1-1-2">
<li id="subsec-prediction-modeling-5-3-1-1-2-1"><div class="para" id="subsec-prediction-modeling-5-3-1-1-2-1-1">Mean Squared Error (MSE): Average of squared differences between predicted and actual values</div></li>
<li id="subsec-prediction-modeling-5-3-1-1-2-2"><div class="para" id="subsec-prediction-modeling-5-3-1-1-2-2-1">Root Mean Squared Error (RMSE): Square root of MSE, in the same units as the target variable</div></li>
<li id="subsec-prediction-modeling-5-3-1-1-2-3"><div class="para" id="subsec-prediction-modeling-5-3-1-1-2-3-1">Mean Absolute Error (MAE): Average of absolute differences between predicted and actual values</div></li>
<li id="subsec-prediction-modeling-5-3-1-1-2-4"><div class="para" id="subsec-prediction-modeling-5-3-1-1-2-4-1">R-squared: Proportion of variance in the dependent variable explained by the model</div></li>
</ul>
</div></li>
<li id="subsec-prediction-modeling-5-3-2"><div class="para logical" id="subsec-prediction-modeling-5-3-2-1">
<div class="para">
<dfn class="terminology">For Classification Models</dfn>:</div>
<ul class="circle" id="subsec-prediction-modeling-5-3-2-1-2">
<li id="subsec-prediction-modeling-5-3-2-1-2-1"><div class="para" id="subsec-prediction-modeling-5-3-2-1-2-1-1">Accuracy: Proportion of correct predictions</div></li>
<li id="subsec-prediction-modeling-5-3-2-1-2-2"><div class="para" id="subsec-prediction-modeling-5-3-2-1-2-2-1">Precision: Proportion of true positives among positive predictions</div></li>
<li id="subsec-prediction-modeling-5-3-2-1-2-3"><div class="para" id="subsec-prediction-modeling-5-3-2-1-2-3-1">Recall: Proportion of true positives that are correctly identified</div></li>
<li id="subsec-prediction-modeling-5-3-2-1-2-4"><div class="para" id="subsec-prediction-modeling-5-3-2-1-2-4-1">F1 Score: Harmonic mean of precision and recall</div></li>
<li id="subsec-prediction-modeling-5-3-2-1-2-5"><div class="para" id="subsec-prediction-modeling-5-3-2-1-2-5-1">ROC Curve and AUC: Visualization and measure of classification performance</div></li>
</ul>
</div></li>
</ul></section><div class="code-box"><pre class="program"><code id="rs-prog-predictive-modeling" class="language-none"># Predictive Modeling Examples in R
# Set a seed for reproducibility
set.seed(123)

# Load necessary data
data(mtcars)

# Data preparation
# Let's predict mpg using weight and horsepower
# First, standardize the predictor variables
mtcars$wt_std &lt;- scale(mtcars$wt)
mtcars$hp_std &lt;- scale(mtcars$hp)

# Data splitting (70% training, 30% testing)
train_indices &lt;- sample(1:nrow(mtcars), size = round(0.7 * nrow(mtcars)))
train_data &lt;- mtcars[train_indices, ]
test_data &lt;- mtcars[-train_indices, ]

cat("Data split into training (", nrow(train_data), " observations) and test (", 
    nrow(test_data), " observations) sets.\n\n")

# 1. Linear Regression Model
# --------------------------

cat("1. LINEAR REGRESSION MODEL\n")
cat("-------------------------\n\n")

# Train the model on the training data
lm_model &lt;- lm(mpg ~ wt_std + hp_std, data = train_data)
summary(lm_model)

# Make predictions on the test data
lm_predictions &lt;- predict(lm_model, newdata = test_data)

# Evaluate the model performance
lm_mse &lt;- mean((test_data$mpg - lm_predictions)^2)
lm_rmse &lt;- sqrt(lm_mse)
lm_mae &lt;- mean(abs(test_data$mpg - lm_predictions))
lm_r2 &lt;- 1 - sum((test_data$mpg - lm_predictions)^2) / sum((test_data$mpg - mean(test_data$mpg))^2)

cat("Model Performance on Test Data:\n")
cat("Mean Squared Error (MSE):", round(lm_mse, 3), "\n")
cat("Root Mean Squared Error (RMSE):", round(lm_rmse, 3), "\n")
cat("Mean Absolute Error (MAE):", round(lm_mae, 3), "\n")
cat("R-squared:", round(lm_r2, 3), "\n\n")

# Visualize actual vs. predicted values
plot(test_data$mpg, lm_predictions, 
     main = "Actual vs. Predicted MPG",
     xlab = "Actual MPG",
     ylab = "Predicted MPG",
     pch = 19,
     col = "blue")
abline(0, 1, col = "red", lwd = 2)  # Perfect prediction line
legend("topleft", 
       legend = c("Predictions", "Perfect Prediction Line"),
       col = c("blue", "red"),
       pch = c(19, NA),
       lty = c(NA, 1),
       lwd = c(NA, 2),
       bty = "n")

# Add prediction intervals to understand uncertainty
# Let's create a data frame with a range of weight values and average horsepower
new_data &lt;- data.frame(
  wt = seq(min(mtcars$wt), max(mtcars$wt), length.out = 100),
  hp = mean(mtcars$hp)
)
# Standardize the predictors to match training
new_data$wt_std &lt;- (new_data$wt - mean(mtcars$wt)) / sd(mtcars$wt)
new_data$hp_std &lt;- (new_data$hp - mean(mtcars$hp)) / sd(mtcars$hp)

# Generate predictions with prediction intervals
prediction_intervals &lt;- predict(lm_model, newdata = new_data, interval = "prediction", level = 0.95)

# Plot the predictions with intervals
plot(mtcars$wt, mtcars$mpg,
     main = "MPG vs. Weight with Prediction Intervals",
     xlab = "Weight (1000 lbs)",
     ylab = "Miles Per Gallon",
     pch = 19,
     col = "gray",
     cex = 0.8)

# Add the prediction line
lines(new_data$wt, prediction_intervals[, "fit"], col = "blue", lwd = 2)

# Add the prediction intervals
lines(new_data$wt, prediction_intervals[, "lwr"], col = "red", lty = 2)
lines(new_data$wt, prediction_intervals[, "upr"], col = "red", lty = 2)

# Add a legend
legend("topright", 
       legend = c("Data", "Predicted MPG", "95% Prediction Interval"),
       col = c("gray", "blue", "red"),
       pch = c(19, NA, NA),
       lty = c(NA, 1, 2),
       lwd = c(NA, 2, 1),
       bty = "n")

# 2. Decision Tree Model
# ---------------------

cat("\n2. DECISION TREE MODEL\n")
cat("--------------------\n\n")

# Note: Since we can't install additional packages in the web environment,
# we'll demonstrate the concept using simulated behavior

cat("In a full R environment, you would use the 'rpart' package to build a decision tree:\n\n")
cat("library(rpart)\n")
cat("tree_model &lt;- rpart(mpg ~ wt + hp, data = train_data, method = 'anova')\n")
cat("tree_predictions &lt;- predict(tree_model, newdata = test_data)\n\n")

# Simulate a decision tree prediction
# This is a simplified model, not a real tree
simulate_tree_prediction &lt;- function(wt, hp) {
  if (wt &lt; 3) {
    if (hp &lt; 100) {
      return(28)
    } else {
      return(22)
    }
  } else {
    if (hp &lt; 175) {
      return(18)
    } else {
      return(14)
    }
  }
}

# Apply the simulated prediction to test data
tree_predictions &lt;- numeric(nrow(test_data))
for (i in 1:nrow(test_data)) {
  tree_predictions[i] &lt;- simulate_tree_prediction(test_data$wt[i], test_data$hp[i])
}

# Evaluate the simulated tree model
tree_mse &lt;- mean((test_data$mpg - tree_predictions)^2)
tree_rmse &lt;- sqrt(tree_mse)
tree_mae &lt;- mean(abs(test_data$mpg - tree_predictions))
tree_r2 &lt;- 1 - sum((test_data$mpg - tree_predictions)^2) / sum((test_data$mpg - mean(test_data$mpg))^2)

cat("Simulated Decision Tree Performance on Test Data:\n")
cat("Mean Squared Error (MSE):", round(tree_mse, 3), "\n")
cat("Root Mean Squared Error (RMSE):", round(tree_rmse, 3), "\n")
cat("Mean Absolute Error (MAE):", round(tree_mae, 3), "\n")
cat("R-squared:", round(tree_r2, 3), "\n\n")

# Visualize simulated tree regions
# Create a grid of weight and horsepower values
wt_grid &lt;- seq(min(mtcars$wt), max(mtcars$wt), length.out = 50)
hp_grid &lt;- seq(min(mtcars$hp), max(mtcars$hp), length.out = 50)
grid_data &lt;- expand.grid(wt = wt_grid, hp = hp_grid)

# Apply the simulated tree model to the grid
grid_predictions &lt;- numeric(nrow(grid_data))
for (i in 1:nrow(grid_data)) {
  grid_predictions[i] &lt;- simulate_tree_prediction(grid_data$wt[i], grid_data$hp[i])
}

# Plot the decision regions
# Create a color palette for the predictions
pred_colors &lt;- heat.colors(10)[cut(grid_predictions, breaks = 10, include.lowest = TRUE)]

plot(grid_data$wt, grid_data$hp, 
     col = pred_colors,
     pch = 15,
     cex = 0.5,
     main = "Simulated Decision Tree Regions",
     xlab = "Weight (1000 lbs)",
     ylab = "Horsepower")

# Add the actual data points
points(mtcars$wt, mtcars$hp, 
       col = "black",
       bg = heat.colors(10)[cut(mtcars$mpg, breaks = 10, include.lowest = TRUE)],
       pch = 21,
       cex = 1.5)

# 3. Model Comparison
# ------------------

cat("\n3. MODEL COMPARISON\n")
cat("------------------\n\n")

cat("Comparing Linear Regression and Simulated Decision Tree:\n\n")
cat("                      Linear Regression    Decision Tree (Simulated)\n")
cat("Mean Squared Error    ", sprintf("%-20.3f", lm_mse), tree_mse, "\n")
cat("Root Mean Sq Error    ", sprintf("%-20.3f", lm_rmse), tree_rmse, "\n")
cat("Mean Absolute Error   ", sprintf("%-20.3f", lm_mae), tree_mae, "\n")
cat("R-squared             ", sprintf("%-20.3f", lm_r2), tree_r2, "\n\n")

# Plot both models' predictions side by side
par(mfrow = c(1, 2))

# Linear regression predictions
plot(test_data$mpg, lm_predictions, 
     main = "Linear Regression",
     xlab = "Actual MPG",
     ylab = "Predicted MPG",
     pch = 19,
     col = "blue",
     xlim = c(min(test_data$mpg), max(test_data$mpg)),
     ylim = c(min(test_data$mpg), max(test_data$mpg)))
abline(0, 1, col = "red", lwd = 2)  # Perfect prediction line

# Decision tree predictions
plot(test_data$mpg, tree_predictions, 
     main = "Decision Tree (Simulated)",
     xlab = "Actual MPG",
     ylab = "Predicted MPG",
     pch = 19,
     col = "green",
     xlim = c(min(test_data$mpg), max(test_data$mpg)),
     ylim = c(min(test_data$mpg), max(test_data$mpg)))
abline(0, 1, col = "red", lwd = 2)  # Perfect prediction line

# Reset the plotting layout
par(mfrow = c(1, 1))

# 4. Making Predictions with the Model
# -----------------------------------

cat("\n4. MAKING PREDICTIONS WITH THE MODEL\n")
cat("-----------------------------------\n\n")

cat("Let's use our linear regression model to make predictions for new cars:\n\n")

# Create a few example cars
new_cars &lt;- data.frame(
  car_name = c("Compact Sedan", "Sports Car", "SUV", "Electric Sedan"),
  wt = c(2.2, 3.4, 4.2, 2.8),
  hp = c(120, 300, 210, 240)
)

# Standardize the variables using the same means and standard deviations from the original data
new_cars$wt_std &lt;- (new_cars$wt - mean(mtcars$wt)) / sd(mtcars$wt)
new_cars$hp_std &lt;- (new_cars$hp - mean(mtcars$hp)) / sd(mtcars$hp)

# Make predictions
new_cars$predicted_mpg &lt;- predict(lm_model, newdata = new_cars)

# Display the predictions
cat("Predictions for new cars:\n")
print(new_cars[, c("car_name", "wt", "hp", "predicted_mpg")])

cat("\nInterpretation of predicted MPG values:\n")
for (i in 1:nrow(new_cars)) {
  cat("- The", new_cars$car_name[i], "with weight of", new_cars$wt[i], 
      "thousand lbs and", new_cars$hp[i], "horsepower is predicted to have",
      round(new_cars$predicted_mpg[i], 1), "MPG.\n")
}

# Calculate prediction intervals for the new predictions
prediction_intervals_new &lt;- predict(lm_model, newdata = new_cars, 
                                   interval = "prediction", level = 0.95)

cat("\nPredictions with 95% prediction intervals:\n")
print(cbind(new_cars[, c("car_name")], round(prediction_intervals_new, 1)))

cat("\nInterpretation of prediction intervals:\n")
cat("For example, we're 95% confident that the actual MPG for the Electric Sedan\n")
cat("will be between", round(prediction_intervals_new[4, "lwr"], 1), "and", 
    round(prediction_intervals_new[4, "upr"], 1), "MPG.\n\n")

cat("The wide prediction intervals reflect uncertainty in the model and natural\n")
cat("variability in fuel efficiency even among cars with the same characteristics.\n\n")

# 5. Key considerations in predictive modeling
# ------------------------------------------

cat("\n5. KEY CONSIDERATIONS IN PREDICTIVE MODELING\n")
cat("------------------------------------------\n\n")

cat("When building and using predictive models, remember these important points:\n\n")

cat("1. Model Selection: Choose the simplest model that adequately explains the data.\n")
cat("   Our linear regression model may be preferable to more complex models if the\n")
cat("   performance is similar, due to its interpretability and simplicity.\n\n")

cat("2. Overfitting vs. Underfitting: Complex models might perform well on training\n")
cat("   data but fail to generalize to new data (overfitting). Simple models might\n")
cat("   miss important patterns (underfitting).\n\n")

cat("3. Feature Engineering: Creating new features or transforming existing ones\n")
cat("   can significantly improve model performance. For example, we might consider\n")
cat("   adding an interaction term (wt × hp) to our model.\n\n")

cat("4. Cross-Validation: Instead of a single train-test split, k-fold cross-validation\n")
cat("   provides a more robust assessment of model performance, especially with small datasets.\n\n")

cat("5. Model Interpretability: Simpler models like linear regression offer clearer\n")
cat("   insights into how features affect the outcome, which can be valuable for\n")
cat("   decision-making and communication.\n\n")

cat("6. Prediction Uncertainty: Always communicate the uncertainty in predictions,\n")
cat("   using prediction intervals or similar measures.\n\n")

cat("7. Data Quality: The quality of predictions depends heavily on the quality,\n")
cat("   representativeness, and completeness of the training data.\n\n")
</code></pre></div>
<details id="ex-predictive-modeling" class="exercise exercise-like born-hidden-knowl"><summary class="knowl__link"><h5 class="heading">
<span class="type">Checkpoint</span><span class="space"> </span><span class="codenumber">3.6.1</span><span class="period">.</span><span class="space"> </span><span class="title">Predictive Modeling Practice.</span>
</h5></summary><article class="exercise exercise-like knowl__content"><div class="para" id="ex-predictive-modeling-2-1">Apply your knowledge of predictive modeling to address the following questions:</div></article></details></section><section class="subsection" id="subsec-interpreting-models"><h4 class="heading hide-type">
<span class="type">Subsection</span><span class="space"> </span><span class="codenumber">3.6.2.2</span><span class="space"> </span><span class="title">Interpreting model results</span>
</h4>
<div class="para" id="subsec-interpreting-models-2">Coming soon...</div></section></section></section></div>
<div id="ptx-content-footer" class="ptx-content-footer">
<a class="previous-button button" href="sec-statistical-analysis.html" title="Previous"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cb;</span><span class="name">Prev</span></a><a class="top-button button" href="#" title="Top"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5ce;</span><span class="name">Top</span></a><a class="next-button button" href="ch-advanced-analysis.html" title="Next"><span class="name">Next</span><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cc;</span></a>
</div></main>
</div>
<div id="ptx-page-footer" class="ptx-page-footer">
<a class="pretext-link" href="https://pretextbook.org" title="PreTeXt"><div class="logo"><svg xmlns="http://www.w3.org/2000/svg" height="100%" viewBox="338 3000 8772 6866" role="img"><title>PreTeXt logo</title><g style="stroke-width:.025in; stroke:currentColor; fill:none"><polyline points="472,3590 472,9732 " style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round; "></polyline><path style="stroke-width:126;stroke-linecap:butt;" d="M 4724,9448 A 4660 4660  0  0  1  8598  9259"></path><path style="stroke-width:174;stroke-linecap:butt;" d="M 4488,9685 A 4228 4228  0  0  0   472  9732"></path><path style="stroke-width:126;stroke-linecap:butt;" d="M 4724,3590 A 4241 4241  0  0  1  8598  3496"></path><path style="stroke-width:126;stroke-linecap:round;" d="M 850,3496  A 4241 4241  0  0  1  4724  3590"></path><path style="stroke-width:126;stroke-linecap:round;" d="M 850,9259  A 4507 4507  0  0  1  4724  9448"></path><polyline points="5385,4299 4062,8125" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8598,3496 8598,9259" style="stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="850,3496 850,9259" style="stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="4960,9685 4488,9685" style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="3070,4582 1889,6141 3070,7700" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="6418,4582 7600,6141 6418,7700" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8976,3590 8976,9732" style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><path style="stroke-width:174;stroke-linecap:butt;" d="M 4960,9685 A 4228 4228  0  0  1  8976  9732"></path></g></svg></div></a><a class="runestone-link" href="https://runestone.academy" title="Runestone Academy"><img class="logo" src="https://runestone.academy/runestone/static/images/RAIcon_cropped.png" alt="Runstone Academy logo"></a><a class="mathjax-link" href="https://www.mathjax.org" title="MathJax"><img class="logo" src="https://www.mathjax.org/badge/badge-square-2.png" alt="MathJax logo"></a>
</div>
</body>
</html>

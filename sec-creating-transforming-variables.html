<!DOCTYPE html>
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<html lang="en-US" dir="ltr">
<!--******************************************-->
<!--*  Authored with PreTeXt                 *-->
<!--*  pretextbook.org                       *-->
<!--*  Theme: denver                         *-->
<!--*  Palette:                              *-->
<!--******************************************-->
<head xmlns:og="http://ogp.me/ns#" xmlns:book="https://ogp.me/ns/book#">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Creating and transforming variables</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0">
<link href="_static/pretext/css/theme.css" rel="stylesheet" type="text/css">
<link href="_static/pretext/css/ol-markers.css" rel="stylesheet" type="text/css">
<script>
var runestoneMathReady = new Promise((resolve) => window.rsMathReady = resolve);
window.MathJax = {
  "tex": {
    "inlineMath": [
      [
        "\\(",
        "\\)"
      ]
    ],
    "tags": "none",
    "tagSide": "right",
    "tagIndent": ".8em",
    "packages": {
      "[+]": [
        "base",
        "extpfeil",
        "ams",
        "amscd",
        "color",
        "newcommand",
        "knowl"
      ]
    }
  },
  "options": {
    "ignoreHtmlClass": "tex2jax_ignore|ignore-math",
    "processHtmlClass": "process-math",
    "renderActions": {
      "findScript": [
        10,
        function (doc) {
            document.querySelectorAll('script[type^="math/tex"]').forEach(function(node) {
                var display = !!node.type.match(/; *mode=display/);
                var math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                var text = document.createTextNode('');
                node.parentNode.replaceChild(text, node);
                math.start = {node: text, delim: '', n: 0};
                math.end = {node: text, delim: '', n: 0};
                doc.math.push(math);
            });
        },
        ""
      ]
    }
  },
  "chtml": {
    "scale": 0.98,
    "mtextInheritFont": true
  },
  "loader": {
    "load": [
      "input/asciimath",
      "[tex]/extpfeil",
      "[tex]/amscd",
      "[tex]/color",
      "[tex]/newcommand",
      "[pretext]/mathjaxknowl3.js"
    ],
    "paths": {
      "pretext": "_static/pretext/js/lib"
    }
  },
  "startup": {
    pageReady() {
      return MathJax.startup.defaultPageReady().then(function () {
      console.log("in ready function");
      rsMathReady();
      }
    )}
  }
};
</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta property="og:type" content="book">
<meta property="book:title" content="Introduction to Data Science">
<meta property="book:author" content="Hannah Kurzweil">
<script src="_static/pretext/js/lib/jquery.min.js"></script><script src="_static/pretext/js/lib/jquery.sticky.js"></script><script src="_static/pretext/js/lib/jquery.espy.min.js"></script><script src="_static/pretext/js/pretext.js"></script><script src="_static/pretext/js/pretext_add_on.js?x=1"></script><script src="_static/pretext/js/user_preferences.js"></script><!--** eBookCongig is necessary to configure interactive       **-->
<!--** Runestone components to run locally in reader's browser **-->
<!--** No external communication:                              **-->
<!--**     log level is 0, Runestone Services are disabled     **-->
<script type="text/javascript">
eBookConfig = {};
eBookConfig.useRunestoneServices = false;
eBookConfig.host = 'http://127.0.0.1:8000';
eBookConfig.course = 'PTX_Course_Title_Here';
eBookConfig.basecourse = 'PTX_Base_Course';
eBookConfig.isLoggedIn = false;
eBookConfig.email = '';
eBookConfig.isInstructor = false;
eBookConfig.logLevel = 0;
eBookConfig.username = '';
eBookConfig.readings = null;
eBookConfig.activities = null;
eBookConfig.downloadsEnabled = false;
eBookConfig.allow_pairs = false;
eBookConfig.enableScratchAC = false;
eBookConfig.build_info = "";
eBookConfig.python3 = null;
eBookConfig.runestone_version = '7.6.5';
eBookConfig.jobehost = '';
eBookConfig.proxyuri_runs = '';
eBookConfig.proxyuri_files = '';
eBookConfig.enable_chatcodes =  false;
</script>
<!--*** Runestone Services ***-->
<script src="_static/prefix-runtime.052b07dd5d5bd82e.bundle.js"></script><script src="_static/prefix-723.3e6434f80549315a.bundle.js"></script><script src="_static/prefix-runestone.253ff4af1e53e55f.bundle.js"></script><link rel="stylesheet" type="text/css" href="_static/prefix-723.3bccd435914aa0ff.css">
<link rel="stylesheet" type="text/css" href="_static/prefix-runestone.5bdeacdba067a0e3.css">
<script src="https://sagecell.sagemath.org/static/embedded_sagecell.js"></script><script src="_static/pretext/js/lti_iframe_resizer.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/components/prism-core.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/autoloader/prism-autoloader.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/line-numbers/prism-line-numbers.min.js" integrity="sha512-dubtf8xMHSQlExGRQ5R7toxHLgSDZ0K7AunqPWHXmJQ8XyVIG19S1T95gBxlAeGOK02P4Da2RTnQz0Za0H0ebQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/line-highlight/prism-line-highlight.min.js" integrity="sha512-93uCmm0q+qO5Lb1huDqr7tywS8A2TFA+1/WHvyiWaK6/pvsFl6USnILagntBx8JnVbQH5s3n0vQZY6xNthNfKA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.9/lunr.min.js" integrity="sha512-4xUl/d6D6THrAnXAwGajXkoWaeMNwEKK4iNfq5DotEbLPAfk6FSxSP3ydNxqDgCw1c/0Z1Jg6L8h2j+++9BZmg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="lunr-pretext-search-index.js" async=""></script><script src="_static/pretext/js/pretext_search.js"></script><script src="_static/pretext/js/lib/knowl.js"></script><!--knowl.js code controls Sage Cells within knowls--><script>sagecellEvalName='Evaluate (Sage)';
</script>
</head>
<body id="changeme" class="pretext book ignore-math">
<a class="assistive" href="#ptx-content">Skip to main content</a><header id="ptx-masthead" class="ptx-masthead"><div class="ptx-banner"><div class="title-container">
<h1 class="heading"><a href="data-science-intro.html"><span class="title">Introduction to Data Science:</span> <span class="subtitle">Unlocking Insights from Data</span></a></h1>
<p class="byline">Hannah Kurzweil</p>
</div></div></header><nav id="ptx-navbar" class="ptx-navbar navbar"><div class="ptx-navbar-contents">
<button class="toc-toggle button" title="Contents"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5d2;</span><span class="name">Contents</span></button><div class="searchbox">
<div class="searchwidget"><button id="searchbutton" class="searchbutton button" type="button" title="Search book"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe8b6;</span><span class="name">Search Book</span></button></div>
<div id="searchresultsplaceholder" class="searchresultsplaceholder" style="display: none">
<div class="search-results-controls">
<input aria-label="Search term" id="ptxsearch" class="ptxsearch" type="text" name="terms" placeholder="Search term"><button title="Close search" id="closesearchresults" class="closesearchresults"><span class="material-symbols-outlined">close</span></button>
</div>
<h2 class="search-results-heading">Search Results: </h2>
<div id="searchempty" class="searchempty"><span>No results.</span></div>
<ol id="searchresults" class="searchresults"></ol>
</div>
</div>
<span class="nav-other-controls"><button id="light-dark-button" class="light-dark-button button" title="Dark Mode"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe51c;</span><span class="name">Dark Mode</span></button></span><span class="treebuttons"><a class="previous-button button" href="sec-data-transformation.html" title="Previous"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cb;</span><span class="name">Prev</span></a><a class="up-button button" href="ch-data-and-programming-foundations.html" title="Up"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5ce;</span><span class="name">Up</span></a><a class="next-button button" href="sec-working-with-web-data.html" title="Next"><span class="name">Next</span><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cc;</span></a></span>
</div></nav><div id="latex-macros" class="hidden-content process-math" style="display:none"><span class="process-math">\(\newcommand{\N}{\mathbb N} \newcommand{\Z}{\mathbb Z} \newcommand{\Q}{\mathbb Q} \newcommand{\R}{\mathbb R}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\definecolor{fillinmathshade}{gray}{0.9}
\newcommand{\fillinmath}[1]{\mathchoice{\colorbox{fillinmathshade}{$\displaystyle     \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\textstyle        \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptstyle      \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptscriptstyle\phantom{\,#1\,}$}}}
\)</span></div>
<div class="ptx-page">
<div id="ptx-sidebar" class="ptx-sidebar"><nav id="ptx-toc" class="ptx-toc depth2 focused" data-preexpanded-levels="0" data-max-levels="2"><ul class="structural toc-item-list contains-active">
<li class="toc-item toc-frontmatter"><div class="toc-title-box"><a href="frontmatter.html" class="internal"><span class="title">Front Matter</span></a></div></li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-understanding-data.html" class="internal"><span class="title">Understanding Data in Our World</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-intro-to-data.html" class="internal"><span class="title">Introduction to Data</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-intro-to-data.html#subsec-what-is-data-science" class="internal"><span class="title">What is Data Science and its Applications?</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-intro-to-data.html#subsec-data-daily-lives" class="internal"><span class="title">Explore how data shapes our daily lives</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-intro-to-data.html#subsec-web-r-setup" class="internal"><span class="title">Set up Web-R accounts and platform familiarization</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-types-of-data.html" class="internal"><span class="title">Types of data and their characteristics</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-types-of-data.html#subsec-qualitative-quantitative" class="internal"><span class="title">Qualitative vs. quantitative data</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-types-of-data.html#subsec-structured-unstructured" class="internal"><span class="title">Structured vs. unstructured data</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-types-of-data.html#subsec-data-types-activity" class="internal"><span class="title">Activity: Identifying data types in real-world examples</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-data-collection.html" class="internal"><span class="title">Data Collection and Sources</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-collection.html#subsec-data-collection-methods" class="internal"><span class="title">How data is collected and by whom</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-collection.html#subsec-data-collection-organizations" class="internal"><span class="title">Organizations that collect data and their motivations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-collection.html#subsec-dikw-pyramid" class="internal"><span class="title">Introduction to the DIKW pyramid</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-collection.html#subsec-ethics-data-collection" class="internal"><span class="title">Discussion: Ethics of data collection</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-data-sources.html" class="internal"><span class="title">Primary vs. secondary data sources</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-sources.html#subsec-primary-secondary-data" class="internal"><span class="title">Distinguishing between data sources</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-sources.html#subsec-reliability-validity" class="internal"><span class="title">Reliability and validity of different sources</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-sources.html#subsec-personal-data-tracking" class="internal"><span class="title">Mini-project introduction: Personal data tracking exercise</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-data-quality.html" class="internal"><span class="title">Data Quality and Evaluation</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-quality.html#subsec-dataset-quality" class="internal"><span class="title">Evaluating dataset quality</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-quality.html#subsec-5vs-framework" class="internal"><span class="title">The 5Vs framework: Volume, Velocity, Variety, Veracity, Value</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-quality.html#subsec-identifying-biases" class="internal"><span class="title">Identifying biases in datasets</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-quality.html#subsec-apply-5vs" class="internal"><span class="title">Activity: Apply 5Vs to evaluate sample datasets</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-quality.html#subsec-personal-data-tracking-checkin" class="internal"><span class="title">Project 1 check-in: Personal data tracking discussion</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-data-impact.html" class="internal"><span class="title">Data Impact and Ethics</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-impact.html#subsec-data-equity-impact" class="internal"><span class="title">Data’s impact on equity and society</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-impact.html#subsec-data-bias-impact" class="internal"><span class="title">How data can perpetuate or mitigate biases</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-impact.html#subsec-algorithmic-bias-cases" class="internal"><span class="title">Case studies in algorithmic bias</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-impact.html#subsec-responsible-data-practices" class="internal"><span class="title">Discussion: Responsible data practices</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-unit-one-conclusion.html" class="internal"><span class="title">Unit 1 Conclusion</span></a></div>
<ul class="structural toc-item-list"><li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-unit-one-conclusion.html#subsec-data-reflection" class="internal"><span class="title">Reflection on data’s role in students’ lives</span></a></div></li></ul>
</li>
</ul>
</li>
<li class="toc-item toc-chapter contains-active">
<div class="toc-title-box"><a href="ch-data-and-programming-foundations.html" class="internal"><span class="title">Data and Programming Foundations</span></a></div>
<ul class="structural toc-item-list contains-active">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-intro-to-web-r.html" class="internal"><span class="title">Introduction to Web-R</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-intro-to-web-r.html#subsec-r-environment" class="internal"><span class="title">R environment overview and basic syntax</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-intro-to-web-r.html#subsec-variables-datatypes" class="internal"><span class="title">Variables, data types, and basic operations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-intro-to-web-r.html#subsec-r-practice" class="internal"><span class="title">Hands-on practice: Simple calculations and variable assignments</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-data-structures.html" class="internal"><span class="title">Working with data structures</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-structures.html#subsec-r-data-structures" class="internal"><span class="title">Lists and Dataframes</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-structures.html#subsec-manipulating-structures" class="internal"><span class="title">Creating and manipulating basic data structures</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-structures.html#subsec-exercise-data-structures" class="internal"><span class="title">Exercise: Building and transforming data structures</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-data-cleaning.html" class="internal"><span class="title">Data Cleaning and Organizing</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-cleaning.html#subsec-why-clean-data" class="internal"><span class="title">Why Clean Data Matters</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-cleaning.html#subsec-common-data-issues" class="internal"><span class="title">Common Data Quality Issues</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-cleaning.html#subsec-data-cleaning-steps" class="internal"><span class="title">Data Cleaning Process</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-cleaning.html#subsec-data-cleaning-R" class="internal"><span class="title">Data Cleaning in R</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-cleaning.html#subsec-tidy-data" class="internal"><span class="title">Tidy Data Principles</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-cleaning.html#subsec-data-validation" class="internal"><span class="title">Data Validation</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-data-import.html" class="internal"><span class="title">Data Import and Exploration</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-import.html#subsec-importing-data" class="internal"><span class="title">Reading CSV files and other data formats</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-import.html#subsec-data-inspection" class="internal"><span class="title">Basic data inspection functions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-import.html#subsec-activity-import-explore" class="internal"><span class="title">Activity: Import and explore a dataset of interest</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-data-exploration.html" class="internal"><span class="title">Data exploration techniques</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-exploration.html#subsec-summary-statistics" class="internal"><span class="title">Summary statistics and data summaries</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-exploration.html#subsec-initial-visualization" class="internal"><span class="title">Initial data visualization</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-exploration.html#subsec-exploratory-analysis" class="internal"><span class="title">Exercise: Exploratory analysis of a dataset</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-data-transformation.html" class="internal"><span class="title">Data Transformation</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-transformation.html#subsec-filtering-selecting" class="internal"><span class="title">Filtering and selecting data</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-transformation.html#subsec-subsetting-dataframes" class="internal"><span class="title">Subsetting data frames</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data-transformation.html#subsec-activity-extract-subsets" class="internal"><span class="title">Activity: Extract meaningful subsets from datasets</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section contains-active">
<div class="toc-title-box"><a href="sec-creating-transforming-variables.html" class="internal"><span class="title">Creating and transforming variables</span></a></div>
<ul class="structural toc-item-list active">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-creating-transforming-variables.html#subsec-adding-modifying-columns" class="internal"><span class="title">Adding and modifying columns</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-creating-transforming-variables.html#subsec-reshaping-data" class="internal"><span class="title">Reshaping data (wide vs. long format)</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-creating-transforming-variables.html#subsec-group-work-transformation" class="internal"><span class="title">Group work: Begin transforming a dataset for mid-term project</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-working-with-web-data.html" class="internal"><span class="title">Working with Web Data</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-working-with-web-data.html#subsec-intro-to-apis" class="internal"><span class="title">Introduction to APIs</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-working-with-web-data.html#subsec-using-r-with-apis" class="internal"><span class="title">Using R to access web data</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-working-with-web-data.html#subsec-api-demonstration" class="internal"><span class="title">Demonstration: Extracting data from a simple API</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-working-with-web-data.html#subsec-web-project-work" class="internal"><span class="title">Web data project work</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-mid-term-project.html" class="internal"><span class="title">Mid-Term Project Topic</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-mid-term-project.html#subsec-project-work-session" class="internal"><span class="title">Mid-term project work session</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-mid-term-project.html#subsec-consultations" class="internal"><span class="title">Instructor and peer consultations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-mid-term-project.html#subsec-progress-checkins" class="internal"><span class="title">Progress check-ins</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-mid-term-presentations.html" class="internal"><span class="title">Mid-term project presentations</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-mid-term-presentations.html#subsec-presentation-guidelines" class="internal"><span class="title">Presentation guidelines</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-mid-term-presentations.html#subsec-presentation-session" class="internal"><span class="title">Groups present their data transformation and analysis</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-mid-term-presentations.html#subsec-feedback-discussion" class="internal"><span class="title">Peer feedback and discussion</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-mid-term-presentations.html#subsec-computational-reflection" class="internal"><span class="title">Reflection on computational techniques learned</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-data-analysis.html" class="internal"><span class="title">Data Analysis and Visualization with Web-R</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-visualization-principles.html" class="internal"><span class="title">Data Visualization Principles</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-visualization-principles.html#subsec-effective-visualization" class="internal"><span class="title">Principles of effective visualization</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-visualization-principles.html#subsec-visual-perception" class="internal"><span class="title">Visual perception principles</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-visualization-principles.html#subsec-choosing-charts" class="internal"><span class="title">Choosing appropriate chart types</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-visualization-principles.html#subsec-critique-visualizations" class="internal"><span class="title">Activity: Critique and improve sample visualizations</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-intro-ggplot2.html" class="internal"><span class="title">Introduction to ggplot2</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-intro-ggplot2.html#subsec-ggplot2-intro" class="internal"><span class="title">Grammar of graphics concept</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-intro-ggplot2.html#subsec-basic-ggplot" class="internal"><span class="title">Creating basic plots in ggplot2</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-intro-ggplot2.html#subsec-transform-to-ggplot" class="internal"><span class="title">Exercise: Transform basic R plots into ggplot2</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-advanced-visualizations.html" class="internal"><span class="title">Advanced Visualizations</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-advanced-visualizations.html#subsec-single-var-viz" class="internal"><span class="title">Histograms, density plots, and bar charts</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-advanced-visualizations.html#subsec-aesthetics-themes" class="internal"><span class="title">Customizing aesthetics and themes</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-advanced-visualizations.html#subsec-practice-polished-plots" class="internal"><span class="title">Hands-on practice: Create polished single-variable plots</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-relationships-viz.html" class="internal"><span class="title">Relationships between variables</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-relationships-viz.html#subsec-scatter-plots" class="internal"><span class="title">Scatter plots, line charts, and heatmaps</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-relationships-viz.html#subsec-visualizing-correlations" class="internal"><span class="title">Visualizing correlations and patterns</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-relationships-viz.html#subsec-activity-relationship-viz" class="internal"><span class="title">Activity: Create visualizations showing relationships in data</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-statistical-analysis.html" class="internal"><span class="title">Statistical Analysis</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-statistical-analysis.html#subsec-descriptive-stats" class="internal"><span class="title">Measures of center and spread</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-statistical-analysis.html#subsec-distributions-outliers" class="internal"><span class="title">Distributions and outliers</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-statistical-analysis.html#subsec-exercise-stats-summary" class="internal"><span class="title">Exercise: Statistical summary of datasets</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-statistical-testing.html" class="internal"><span class="title">Introduction to statistical testing</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-statistical-testing.html#subsec-confidence-intervals" class="internal"><span class="title">Confidence intervals</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-statistical-testing.html#subsec-linear-regression" class="internal"><span class="title">Linear regression basics</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-statistical-testing.html#subsec-hypothesis-testing" class="internal"><span class="title">Hypothesis testing basics</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-statistical-testing.html#sec-anova-basics" class="internal"><span class="title">ANOVA basics</span></a></div></li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-statistical-testing.html#sec-advanced-analysis" class="internal"><span class="title">Advanced Analysis and Final Project Work</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-statistical-testing.html#subsec-prediction-modeling" class="internal"><span class="title">Building simple predictive models</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-statistical-testing.html#subsec-interpreting-models" class="internal"><span class="title">Interpreting model results</span></a></div></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-chapter"><div class="toc-title-box"><a href="ch-advanced-analysis.html" class="internal"><span class="title">Advanced Analysis and Final Project Work</span></a></div></li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-course-projects.html" class="internal"><span class="title">Solidifying Concepts: Course Projects</span></a></div>
<ul class="structural toc-item-list"><li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-personal-data-tracking.html" class="internal"><span class="title">Project 1: Gleaning Insights from Personal Data</span></a></div></li></ul>
</li>
<li class="toc-item toc-backmatter"><div class="toc-title-box"><a href="backmatter.html" class="internal"><span class="title">Backmatter</span></a></div></li>
</ul></nav></div>
<main class="ptx-main"><div id="ptx-content" class="ptx-content"><section class="section" id="sec-creating-transforming-variables"><h2 class="heading hide-type">
<span class="type">Section</span><span class="space"> </span><span class="codenumber"></span><span class="space"> </span><span class="title">Creating and transforming variables</span>
</h2>
<section class="subsection" id="subsec-adding-modifying-columns"><h3 class="heading hide-type">
<span class="type">Subsection</span><span class="space"> </span><span class="codenumber"></span><span class="space"> </span><span class="title">Adding and modifying columns</span>
</h3>
<div class="para" id="subsec-adding-modifying-columns-2">Creating new variables and transforming existing ones are essential data preparation tasks. In R, you can easily add or modify columns in a data frame using various techniques.</div>
<div class="para" id="subsec-adding-modifying-columns-3">Common ways to add or modify columns:</div>
<ul class="disc" id="subsec-adding-modifying-columns-4">
<li id="subsec-adding-modifying-columns-4-1"><div class="para" id="subsec-adding-modifying-columns-4-1-1">
<dfn class="terminology">Direct assignment</dfn>: <code class="code-inline tex2jax_ignore">df$new_col &lt;- values</code>
</div></li>
<li id="subsec-adding-modifying-columns-4-2"><div class="para" id="subsec-adding-modifying-columns-4-2-1">
<dfn class="terminology">Calculated columns</dfn>: <code class="code-inline tex2jax_ignore">df$new_col &lt;- df$col1 + df$col2</code>
</div></li>
<li id="subsec-adding-modifying-columns-4-3"><div class="para" id="subsec-adding-modifying-columns-4-3-1">
<dfn class="terminology">Applying functions</dfn>: <code class="code-inline tex2jax_ignore">df$new_col &lt;- function(df$existing_col)</code>
</div></li>
<li id="subsec-adding-modifying-columns-4-4"><div class="para" id="subsec-adding-modifying-columns-4-4-1">
<dfn class="terminology">Conditional assignment</dfn>: <code class="code-inline tex2jax_ignore">df$new_col &lt;- ifelse(condition, value_if_true, value_if_false)</code>
</div></li>
<li id="subsec-adding-modifying-columns-4-5"><div class="para" id="subsec-adding-modifying-columns-4-5-1">
<dfn class="terminology">Using transform()</dfn>: <code class="code-inline tex2jax_ignore">df &lt;- transform(df, new_col = expression)</code>
</div></li>
<li id="subsec-adding-modifying-columns-4-6"><div class="para" id="subsec-adding-modifying-columns-4-6-1">
<dfn class="terminology">Category creation</dfn>: <code class="code-inline tex2jax_ignore">df$new_cat &lt;- cut(df$numeric_var, breaks, labels)</code>
</div></li>
</ul>
<div class="code-box"><pre class="program"><code id="rs-prog-adding-columns" class="language-none"># Create a sample dataset
students &lt;- data.frame(
  id = 1:6,
  name = c("Alice", "Bob", "Charlie", "David", "Emma", "Frank"),
  math_score = c(85, 92, 78, 95, 88, 72),
  science_score = c(92, 88, 75, 89, 94, 77)
)

# Display the original data
students

# 1. Direct assignment - Add a new column
students$english_score &lt;- c(88, 90, 82, 78, 95, 85)
students

# 2. Calculated columns - Calculate average score
students$avg_score &lt;- (students$math_score + students$science_score + students$english_score) / 3
students

# 3. Using a function - Round the average score
students$avg_score_rounded &lt;- round(students$avg_score)
students

# 4. Conditional assignment with ifelse() - Assign grades
students$grade &lt;- ifelse(students$avg_score &gt;= 90, "A",
                     ifelse(students$avg_score &gt;= 80, "B",
                            ifelse(students$avg_score &gt;= 70, "C",
                                   ifelse(students$avg_score &gt;= 60, "D", "F"))))
students

# 5. Using transform() - Add multiple columns at once
students &lt;- transform(students,
                    math_pct = math_score / 100,
                    science_pct = science_score / 100,
                    english_pct = english_score / 100)
students

# 6. Creating categories with cut() - Group by performance
students$performance_group &lt;- cut(students$avg_score,
                               breaks = c(0, 70, 80, 90, 100),
                               labels = c("Needs Improvement", "Satisfactory", "Good", "Excellent"),
                               right = FALSE)
students

# 7. Creating a binary variable
students$honor_roll &lt;- students$avg_score &gt;= 85
students

# 8. Modifying an existing column
students$math_score &lt;- students$math_score + 2  # Curve everyone's math score
students

# 9. Creating an index or rank
students$rank &lt;- rank(-students$avg_score)  # Negative for descending order
students

# 10. Using apply() to create a column
# Calculate maximum score across all subjects
students$max_score &lt;- apply(students[, c("math_score", "science_score", "english_score")], 1, max)
students
</code></pre></div>
<div class="para" id="subsec-adding-modifying-columns-6">More advanced transformations:</div>
<div class="code-box"><pre class="program"><code id="rs-prog-advanced-transformations" class="language-none"># Load the iris dataset
data(iris)

# Create a copy to work with
iris_modified &lt;- iris

# Z-score standardization (mean = 0, sd = 1)
# For Sepal.Length
iris_modified$Sepal.Length_z &lt;- (iris$Sepal.Length - mean(iris$Sepal.Length)) / sd(iris$Sepal.Length)

# Check that the new variable has mean ≈ 0 and sd ≈ 1
mean(iris_modified$Sepal.Length_z)
sd(iris_modified$Sepal.Length_z)

# Min-max scaling (range [0,1])
# For Sepal.Width
iris_modified$Sepal.Width_scaled &lt;- (iris$Sepal.Width - min(iris$Sepal.Width)) / 
                                (max(iris$Sepal.Width) - min(iris$Sepal.Width))

# Check that the range is [0,1]
range(iris_modified$Sepal.Width_scaled)

# Log transformation (useful for skewed data)
# Create a sample skewed variable
set.seed(123)
skewed_data &lt;- data.frame(
  id = 1:100,
  value = rlnorm(100, meanlog = 2, sdlog = 1)  # Log-normal distribution
)

# Plot the original skewed data
hist(skewed_data$value, 
     main = "Original Skewed Distribution",
     xlab = "Value",
     col = "lightblue")

# Apply log transformation
skewed_data$log_value &lt;- log(skewed_data$value)

# Plot the transformed data
hist(skewed_data$log_value, 
     main = "Log-Transformed Distribution",
     xlab = "Log(Value)",
     col = "lightgreen")

# Square root transformation (another option for right-skewed data)
skewed_data$sqrt_value &lt;- sqrt(skewed_data$value)

# Plot the square root transformed data
hist(skewed_data$sqrt_value, 
     main = "Square Root Transformed Distribution",
     xlab = "Sqrt(Value)",
     col = "lightpink")

# Creating dummy variables (one-hot encoding)
# For iris Species
iris_dummy &lt;- iris

# Create dummy variables for Species
iris_dummy$is_setosa &lt;- as.integer(iris$Species == "setosa")
iris_dummy$is_versicolor &lt;- as.integer(iris$Species == "versicolor")
iris_dummy$is_virginica &lt;- as.integer(iris$Species == "virginica")

# Check the dummy variables
head(iris_dummy[, c("Species", "is_setosa", "is_versicolor", "is_virginica")])

# Binning continuous variables
# Bin Petal.Length into categories
iris_dummy$petal_size &lt;- cut(iris$Petal.Length,
                           breaks = c(0, 2, 4, 7),
                           labels = c("small", "medium", "large"),
                           include.lowest = TRUE)

# Check the binning
table(iris_dummy$petal_size, iris_dummy$Species)

# String manipulations
# Create a sample dataset with text
text_data &lt;- data.frame(
  id = 1:5,
  full_name = c("John Smith", "Mary Johnson", "Robert Brown", "Linda Davis", "James Wilson")
)

# Extract first name
text_data$first_name &lt;- sapply(strsplit(text_data$full_name, " "), `[`, 1)

# Extract last name
text_data$last_name &lt;- sapply(strsplit(text_data$full_name, " "), `[`, 2)

# Create initials
text_data$initials &lt;- paste0(substr(text_data$first_name, 1, 1), 
                          substr(text_data$last_name, 1, 1))

# Make names uppercase
text_data$full_name_upper &lt;- toupper(text_data$full_name)

text_data
</code></pre></div>
<details id="ex-column-transformations" class="exercise exercise-like born-hidden-knowl"><summary class="knowl__link"><h4 class="heading">
<span class="type">Checkpoint</span><span class="space"> </span><span class="codenumber">74</span><span class="period">.</span><span class="space"> </span><span class="title">Column Transformation Practice.</span>
</h4></summary><article class="exercise exercise-like knowl__content"><div class="para" id="ex-column-transformations-2-1">Using the mtcars dataset, perform the following transformations:</div></article></details></section><section class="subsection" id="subsec-reshaping-data"><h3 class="heading hide-type">
<span class="type">Subsection</span><span class="space"> </span><span class="codenumber"></span><span class="space"> </span><span class="title">Reshaping data (wide vs. long format)</span>
</h3>
<div class="para" id="subsec-reshaping-data-2">Data often needs to be reshaped between "wide" and "long" formats for different types of analysis or visualization. Understanding these formats and how to convert between them is an important skill in data science.</div>
<div class="para" id="subsec-reshaping-data-3">Wide format vs. Long format:</div>
<ul class="disc" id="subsec-reshaping-data-4">
<li id="subsec-reshaping-data-4-1"><div class="para" id="subsec-reshaping-data-4-1-1">
<dfn class="terminology">Wide format</dfn>: Each subject/entity is in a single row, with multiple columns for different variables or time points</div></li>
<li id="subsec-reshaping-data-4-2"><div class="para" id="subsec-reshaping-data-4-2-1">
<dfn class="terminology">Long format</dfn>: Each observation is in a separate row, with columns for ID variables, measurement variables, and values</div></li>
</ul>
<div class="para" id="subsec-reshaping-data-5">In base R, reshaping can be done with the <code class="code-inline tex2jax_ignore">reshape()</code> function:</div>
<div class="code-box"><pre class="program"><code id="rs-prog-reshaping" class="language-none"> # Create a sample dataset in wide format
 # Student scores for different subjects
 student_scores_wide &lt;- data.frame(
   student_id = 1:5,
   name = c("Alice", "Bob", "Charlie", "Diana", "Eduardo"),
   math = c(85, 92, 78, 95, 88),
   science = c(92, 88, 75, 89, 94),
   english = c(88, 90, 82, 78, 95)
 )
 
 # Display the wide format data
 student_scores_wide
 
 # Reshape from wide to long format using reshape()
 student_scores_long &lt;- reshape(
   student_scores_wide,
   direction = "long",          # Reshape to long format
   varying = c("math", "science", "english"),  # Columns to reshape
   v.names = "score",           # Name for the values column
   timevar = "subject",         # Name for the variable names column
   idvar = c("student_id", "name"),  # ID columns to keep
   times = c("math", "science", "english"),  # Values for the timevar column
   new.row.names = 1:15         # New row names (5 students × 3 subjects)
 )
 
 # Display the long format data
 student_scores_long
 
 # Sort for better viewing
 student_scores_long &lt;- student_scores_long[order(student_scores_long$student_id), ]
 student_scores_long
 
 # Reshape back from long to wide format
 student_scores_wide2 &lt;- reshape(
   student_scores_long,
   direction = "wide",          # Reshape to wide format
   idvar = c("student_id", "name"),  # ID columns
   timevar = "subject"          # Variable that contains the column names
 )
 
 # Fix column names by removing "score." prefix
 names(student_scores_wide2) &lt;- gsub("score.", "", names(student_scores_wide2))
 
 # Display the result of reshaping back to wide format
 student_scores_wide2
 
 # Example with multiple measurement variables
 # Create a dataset with students' scores and absences in wide format
 student_data_wide &lt;- data.frame(
   student_id = 1:4,
   math_score = c(85, 92, 78, 95),
   science_score = c(92, 88, 75, 89),
   math_absences = c(2, 0, 3, 1),
   science_absences = c(1, 2, 4, 0)
 )
 
 student_data_wide
 
 # Reshape to long format with multiple measurement variables
 student_data_long &lt;- reshape(
   student_data_wide,
   direction = "long",
   varying = list(c("math_score", "science_score"), 
                 c("math_absences", "science_absences")),
   v.names = c("score", "absences"),
   timevar = "subject",
   times = c("math", "science"),
   idvar = "student_id"
 )
 
 # Sort for better viewing
 student_data_long &lt;- student_data_long[order(student_data_long$student_id), ]
 student_data_long
 
 # Another approach using melt function from reshape2 package (not run since we don't have the package in Web-R)
 # Commented out as it requires a package
 # install.packages("reshape2")
 # library(reshape2)
 # student_scores_long_alt &lt;- melt(student_scores_wide, 
 #                                id.vars = c("student_id", "name"),
 #                                measure.vars = c("math", "science", "english"),
 #                                variable.name = "subject",
 #                                value.name = "score")
 
# Real-world example - Measuring multiple variables over time
 # Create a dataset of patient measurements over time
 patients &lt;- data.frame(
   patient_id = rep(1:3, each = 3),
   visit = rep(c("baseline", "month_3", "month_6"), 3),
   weight = c(70, 68, 67, 85, 83, 82, 62, 60, 61),
   blood_pressure = c(140, 135, 130, 150, 145, 140, 125, 120, 120),
   cholesterol = c(220, 200, 195, 240, 220, 210, 190, 185, 180)
 )
 
 # View the initial data (in wide format by visit)
 patients
 
 # Reshape to have all measurements for each patient-visit in a single row
 # We're already in long format for visit, but wide format for measurements
 
 # Let's reshape to have each measurement in its own row
 patients_long &lt;- reshape(
   patients,
   direction = "long",
   varying = c("weight", "blood_pressure", "cholesterol"),
   v.names = "value",
   timevar = "measurement",
   idvar = c("patient_id", "visit"),
   times = c("weight", "blood_pressure", "cholesterol")
 )
 
 # Sort for better viewing
 patients_long &lt;- patients_long[order(patients_long$patient_id, patients_long$visit), ]
 patients_long
 
 # Now let's reshape to have each patient in a single row with all visits and measurements
 # First, reshape to have measurements in columns
 patients_wide_meas &lt;- reshape(
   patients_long,
   direction = "wide",
   idvar = c("patient_id", "visit"),
   timevar = "measurement"
 )
 
 patients_wide_meas
 
 # Then reshape to have visits in columns
 patients_wide_all &lt;- reshape(
   patients_wide_meas,
   direction = "wide",
   idvar = "patient_id",
   timevar = "visit"
 )
 
 patients_wide_all
 
 # Cleaning up column names for better readability (not executed in this example)
 # Would need to rename columns like value.weight.baseline to baseline_weight
</code></pre></div>
<details id="ex-reshaping-practice" class="exercise exercise-like born-hidden-knowl"><summary class="knowl__link"><h4 class="heading">
<span class="type">Checkpoint</span><span class="space"> </span><span class="codenumber">75</span><span class="period">.</span><span class="space"> </span><span class="title">Data Reshaping Practice.</span>
</h4></summary><article class="exercise exercise-like knowl__content"><div class="para" id="ex-reshaping-practice-2-1">For each of the following scenarios, determine whether the data should be in wide or long format, and explain why:</div></article></details></section><section class="subsection" id="subsec-group-work-transformation"><h3 class="heading hide-type">
<span class="type">Subsection</span><span class="space"> </span><span class="codenumber"></span><span class="space"> </span><span class="title">Group work: Begin transforming a dataset for mid-term project</span>
</h3>
<article class="activity project-like" id="activity-dataset-transformation"><h4 class="heading">
<span class="type">Activity</span><span class="space"> </span><span class="codenumber">14</span><span class="period">.</span><span class="space"> </span><span class="title">Dataset Transformation for Mid-Term Project.</span>
</h4>
<div class="para" id="activity-dataset-transformation-2-1">In this activity, you will work with partners to prepare a dataset for your mid-term project. The goal is to apply the data transformation techniques you’ve learned to clean, reshape, and enhance a dataset for analysis.</div> <div class="para" id="activity-dataset-transformation-2-2">Instructions:</div> <ol class="decimal" id="activity-dataset-transformation-2-3">
<li id="activity-dataset-transformation-2-3-1"><div class="para" id="activity-dataset-transformation-2-3-1-1">Form groups of 2-3 students</div></li>
<li id="activity-dataset-transformation-2-3-2">
<div class="para" id="activity-dataset-transformation-2-3-2-1">Choose one of the following datasets:</div>
<ul class="disc" id="activity-dataset-transformation-2-3-2-2">
<li id="activity-dataset-transformation-2-3-2-2-1"><div class="para" id="activity-dataset-transformation-2-3-2-2-1-1">The built-in <code class="code-inline tex2jax_ignore">airquality</code> dataset (daily air quality measurements in New York, 1973)</div></li>
<li id="activity-dataset-transformation-2-3-2-2-2"><div class="para" id="activity-dataset-transformation-2-3-2-2-2-1">The built-in <code class="code-inline tex2jax_ignore">mtcars</code> dataset (fuel consumption and design characteristics for car models)</div></li>
<li id="activity-dataset-transformation-2-3-2-2-3"><div class="para" id="activity-dataset-transformation-2-3-2-2-3-1">The built-in <code class="code-inline tex2jax_ignore">ChickWeight</code> dataset (weight versus age of chicks on different diets)</div></li>
</ul>
</li>
<li id="activity-dataset-transformation-2-3-3">
<div class="para" id="activity-dataset-transformation-2-3-3-1">Perform the following transformations on your chosen dataset:</div>
<ul class="disc" id="activity-dataset-transformation-2-3-3-2">
<li id="activity-dataset-transformation-2-3-3-2-1"><div class="para" id="activity-dataset-transformation-2-3-3-2-1-1">Clean any missing or problematic values</div></li>
<li id="activity-dataset-transformation-2-3-3-2-2"><div class="para" id="activity-dataset-transformation-2-3-3-2-2-1">Create at least three new derived variables based on the existing data</div></li>
<li id="activity-dataset-transformation-2-3-3-2-3"><div class="para" id="activity-dataset-transformation-2-3-3-2-3-1">Reshape the data as needed for your planned analysis</div></li>
<li id="activity-dataset-transformation-2-3-3-2-4"><div class="para" id="activity-dataset-transformation-2-3-3-2-4-1">Create appropriate categorical variables using binning</div></li>
<li id="activity-dataset-transformation-2-3-3-2-5"><div class="para" id="activity-dataset-transformation-2-3-3-2-5-1">Standardize or normalize numerical variables if appropriate</div></li>
</ul>
</li>
<li id="activity-dataset-transformation-2-3-4"><div class="para" id="activity-dataset-transformation-2-3-4-1">Document your transformations and explain the reasoning behind each step</div></li>
<li id="activity-dataset-transformation-2-3-5"><div class="para" id="activity-dataset-transformation-2-3-5-1">Prepare a brief presentation of your transformed dataset and the insights it enables</div></li>
</ol></article><div class="code-box"><pre class="program"><code id="rs-prog-dataset-transformation-example" class="language-none"># Example transformation workflow for the airquality dataset
# This is an example of what students might do in their group work

# Load the dataset
data(airquality)

# Examine the structure
str(airquality)

# Look at the first few rows
head(airquality)

# Check for missing values
summary(airquality)
sum(is.na(airquality))
colSums(is.na(airquality))

# 1. Cleaning missing values
# Method 1: Remove rows with any missing values
airquality_complete &lt;- na.omit(airquality)
dim(airquality)  # Original dimensions
dim(airquality_complete)  # Dimensions after removing NAs

# Method 2: Impute missing values with column means
airquality_imputed &lt;- airquality
for(col in names(airquality)) {
  airquality_imputed[is.na(airquality_imputed[, col]), col] &lt;- 
    mean(airquality[, col], na.rm = TRUE)
}

# Verify imputation
colSums(is.na(airquality_imputed))

# 2. Creating derived variables
# Add a Date column by combining Month and Day
airquality_imputed$Date &lt;- as.Date(paste("1973", airquality_imputed$Month, 
                                  airquality_imputed$Day, sep = "-"))

# Create a Heat Index (simple version)
airquality_imputed$HeatIndex &lt;- airquality_imputed$Temp + 0.05 * airquality_imputed$Temp * airquality_imputed$Wind

# Create Air Quality Index (simplified version)
airquality_imputed$AQI &lt;- (airquality_imputed$Ozone + airquality_imputed$Solar.R) / 2

# Add a Weekend indicator
# First, get the day of the week (1 = Monday, ... 7 = Sunday)
airquality_imputed$Weekday &lt;- as.POSIXlt(airquality_imputed$Date)$wday
# Create a binary weekend indicator (0 = weekday, 1 = weekend)
airquality_imputed$Weekend &lt;- as.integer(airquality_imputed$Weekday %in% c(0, 6))

# 3. Creating categorical variables
# Bin temperature into categories
airquality_imputed$TempCategory &lt;- cut(airquality_imputed$Temp, 
                                 breaks = c(50, 70, 80, 100), 
                                 labels = c("Cool", "Moderate", "Hot"),
                                 include.lowest = TRUE)

# Categorize Ozone levels
airquality_imputed$OzoneLevel &lt;- cut(airquality_imputed$Ozone,
                               breaks = c(0, 30, 60, 100, 200),
                               labels = c("Good", "Moderate", "Unhealthy for Sensitive Groups", "Unhealthy"),
                               include.lowest = TRUE)

# 4. Standardize numerical variables
# Z-score standardization
numeric_cols &lt;- c("Ozone", "Solar.R", "Wind", "Temp")
for(col in numeric_cols) {
  col_z &lt;- paste0(col, "_z")
  airquality_imputed[, col_z] &lt;- scale(airquality_imputed[, col])
}

# 5. Reshape the data for time series analysis
# First, prepare a dataset with just the variables of interest
aq_ts &lt;- airquality_imputed[, c("Date", "Ozone", "Solar.R", "Wind", "Temp")]

# Reshape to long format
aq_long &lt;- reshape(
  aq_ts,
  direction = "long",
  varying = c("Ozone", "Solar.R", "Wind", "Temp"),
  v.names = "Value",
  timevar = "Measurement",
  idvar = "Date",
  times = c("Ozone", "Solar.R", "Wind", "Temp")
)

# Sort for better viewing
aq_long &lt;- aq_long[order(aq_long$Date, aq_long$Measurement), ]

# View the final transformed dataset
head(airquality_imputed)

# View the long format data
head(aq_long)

# 6. Analysis example: How do weather conditions affect air quality?
# Correlation between variables
cors &lt;- cor(airquality_imputed[, c("Ozone", "Solar.R", "Wind", "Temp")])
cors

# Average Ozone by temperature category
aggregate(Ozone ~ TempCategory, data = airquality_imputed, FUN = mean)

# Is air quality worse on weekends?
aggregate(Ozone ~ Weekend, data = airquality_imputed, FUN = mean)

# Visualize the relationship between temperature and ozone
plot(airquality_imputed$Temp, airquality_imputed$Ozone,
     main = "Relationship Between Temperature and Ozone",
     xlab = "Temperature (F)",
     ylab = "Ozone (ppb)",
     pch = 19,
     col = "darkblue")
abline(lm(Ozone ~ Temp, data = airquality_imputed), col = "red", lwd = 2)
</code></pre></div>
<details id="ex-transformation-explanation" class="exercise exercise-like born-hidden-knowl"><summary class="knowl__link"><h4 class="heading">
<span class="type">Checkpoint</span><span class="space"> </span><span class="codenumber">76</span><span class="period">.</span><span class="space"> </span><span class="title">Transformation Explanation.</span>
</h4></summary><article class="exercise exercise-like knowl__content"><div class="para" id="ex-transformation-explanation-2-1">For each of the following data transformations in the example above, explain why it might be useful for analysis:</div></article></details></section></section></div>
<div id="ptx-content-footer" class="ptx-content-footer">
<a class="previous-button button" href="sec-data-transformation.html" title="Previous"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cb;</span><span class="name">Prev</span></a><a class="top-button button" href="#" title="Top"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5ce;</span><span class="name">Top</span></a><a class="next-button button" href="sec-working-with-web-data.html" title="Next"><span class="name">Next</span><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cc;</span></a>
</div></main>
</div>
<div id="ptx-page-footer" class="ptx-page-footer">
<a class="pretext-link" href="https://pretextbook.org" title="PreTeXt"><div class="logo"><svg xmlns="http://www.w3.org/2000/svg" height="100%" viewBox="338 3000 8772 6866" role="img"><title>PreTeXt logo</title><g style="stroke-width:.025in; stroke:currentColor; fill:none"><polyline points="472,3590 472,9732 " style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round; "></polyline><path style="stroke-width:126;stroke-linecap:butt;" d="M 4724,9448 A 4660 4660  0  0  1  8598  9259"></path><path style="stroke-width:174;stroke-linecap:butt;" d="M 4488,9685 A 4228 4228  0  0  0   472  9732"></path><path style="stroke-width:126;stroke-linecap:butt;" d="M 4724,3590 A 4241 4241  0  0  1  8598  3496"></path><path style="stroke-width:126;stroke-linecap:round;" d="M 850,3496  A 4241 4241  0  0  1  4724  3590"></path><path style="stroke-width:126;stroke-linecap:round;" d="M 850,9259  A 4507 4507  0  0  1  4724  9448"></path><polyline points="5385,4299 4062,8125" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8598,3496 8598,9259" style="stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="850,3496 850,9259" style="stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="4960,9685 4488,9685" style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="3070,4582 1889,6141 3070,7700" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="6418,4582 7600,6141 6418,7700" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8976,3590 8976,9732" style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><path style="stroke-width:174;stroke-linecap:butt;" d="M 4960,9685 A 4228 4228  0  0  1  8976  9732"></path></g></svg></div></a><a class="runestone-link" href="https://runestone.academy" title="Runestone Academy"><img class="logo" src="https://runestone.academy/runestone/static/images/RAIcon_cropped.png" alt="Runstone Academy logo"></a><a class="mathjax-link" href="https://www.mathjax.org" title="MathJax"><img class="logo" src="https://www.mathjax.org/badge/badge-square-2.png" alt="MathJax logo"></a>
</div>
</body>
</html>
